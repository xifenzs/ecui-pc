!function(){var e;window.frd=window.frd||{},window.frd.util=window.frd.util||{},frd.util.traverseTree=function(e,t,i){i=i||"_aChildren";var s,n,a=e;for(s=e instanceof Array?e.slice():[e];0!==s.length;)a!==(n=s.shift())&&t&&t(n),n[i]&&s.push.apply(s,n[i]),n=null},frd.util.findTreeNode=function(e,t,i){i=i||"_aChildren";var s,n,a=e;for(s=e instanceof Array?e.slice():[e];0!==s.length;){if(a!==(n=s.shift())&&t&&t(n))return n;n[i]&&s.push.apply(s,n[i]),n=null}},frd.util.findControl=function(e,t){if(e instanceof ecui.ui.Control){for(;e;e=e.getParent())if(e instanceof t)return e;return null}for(;e;e=ecui.dom.parent(e))if(e.getControl&&e.getControl()instanceof t)return e.getControl();return null},frd.util.getToThousands=function(e){if(e||0===e){if(-1==(e=String(e)).indexOf("."))return e.toString().replace(/(\d)(?=(?:\d{3})+$)/g,"$1,");var t=e.substring(0,e.indexOf(".")).replace(/(\d)(?=(?:\d{3})+$)/g,"$1,"),i=e.substring(e.length,e.indexOf("."));return i.length>3&&(i=i.substring(i.indexOf("."),3)),t+i}return""},frd.util.findChildrenControl=function(e,t){if(!e||!t)return[];for(var i,s,n=[],a=[e];0!==a.length;)(i=a.shift()).getControl&&i.getControl()instanceof t?n.push(i.getControl()):(s=ecui.dom.children(i)).length>0&&a.push.apply(a,s);return n},frd.util.setCacheData=function(e,t,i){for(var s=0,n=e,a=t.split(".");s<a.length-1;s++)n=isNaN(a[s+1])?n[a[s]]=n[a[s]]||{}:n[a[s]]=n[a[s]]||[];n[a[s]]=i},frd.util.getDataWithNamePath=function(e,t){if(!e)return"";for(var i=0,s=e,n=t.split(".");i<n.length&&void 0!==(s=s[n[i]]);i++);return s},frd.util.parseObject=function(e,t,i,s){var n;return frd.util.findChildrenControl(e,s||ecui.ui.InputControl).forEach(function(e){var s=e.getFormName&&e.getFormName(),a=e.getFormValue&&e.getFormValue(),r=e.isDisabled();s&&!r&&(i&&(ecui.dispatchEvent(e,"validate")||n||(n=e)),s&&a&&(!e.isFormChecked||e.isFormChecked())&&(s instanceof Array&&a instanceof Array&&s.length===a.length?s.forEach(function(e,i){frd.util.setCacheData(t,e,a[i])}):frd.util.setCacheData(t,s,a)))}),!n||(ecui.dom.scrollIntoViewIfNeeded(n.getMain()),!1)},frd.util.fillForm=function(e,t,i){frd.util.findChildrenControl(e,i||ecui.ui.InputControl).forEach(function(e){var i=e.getFormName();i instanceof Array?e.setValue(i.map(function(e){return frd.util.getDataWithNamePath(t,e)})):i&&e.setValue&&e.setValue(frd.util.getDataWithNamePath(t,i))})},frd.util.addPathToTree=function(e,t,i,s){t=t?t+".":"",e.forEach(function(e,n){e.path=t+n,e.childrenList&&e.childrenList.length>0&&(e.children=e.childrenList),i&&i.length>0&&(e.name=e[i]),s&&s.length>0&&(e.id=e[s]),e.children||(e.children=[]),e.checked=e.checked?e.checked:0,e.isHide=!1,e.children&&e.children.length>0&&frd.util.addPathToTree(e.children,e.path,i,s)})},frd.util.getTreeDataFromSelectedData=function(e,t,i,s){if(!(t&&t.length>0&&e&&e.length>0))return e;var n=JSON.parse(JSON.stringify(e));frd.util.addPathToTree(n,"",i,s);var a=[],r=function(e,t){for(var i=0;i<e.length;i++){var s=e[i];if(s.id==t){a.push(s);break}s.children&&s.children.length>0&&r(s.children,t)}};t.forEach(function(e){for(var t=0;t<n.length;t++){var i=n[t];if(i.id==e){a.push(i);break}i.children&&i.children.length>0&&r(i.children,e)}});var o=function(e){e.children.forEach(function(e){e.checked=1,e.children&&e.children.length>0&&o(e)},this)},c=function(e){if(e.children&&0!==e.children.length){var t=e.children.filter(function(e){return!e.isHide}),i=t.length,s=t.filter(function(e){return 0!==e.checked}).length,n=t.filter(function(e){return 2===e.checked}).length,a=e.checked;return e.checked=0===s?0:0!==n||s<i?2:1,a!==e.checked}return!0};a.forEach(function(e){e.checked=1,o(e),function(e,t){var i=e.path;if(!i||-1!==i.indexOf(".")){var s=i.split(".");for(s.pop();s.length>0;){var n=frd.util.findTreeDataByPath(t,s.join("."));if(s.pop(),0==c(n))break}}}(e,n)});var l=function(e){e.children&&e.children.length>0&&(e.children=e.children.filter(function(e){return l(e),e.checked=e.checked?1:0,e.checked>0}))},u=n.filter(function(e){return l(e),e.checked=e.checked?1:0,e.checked>0});return frd.util.addPathToTree(u,"","",""),u},frd.util.findTreeDataByPath=function(e,t){var i=e;return t.split(".").forEach(function(e,t){i=0===t?i[e]:i.children[e]}),i},frd.util.compileTemplate=function(e,t){var i=ecui.esr.getEngine();if(i)return i.compile(e)(t);console.warn("未找到默认引擎")},frd.util.donloadFile=function(e,t){t=t||{};var i={};Object.assign(i,t),fetch(e,i).then(function(e){return e.blob().then(function(t){var i=document.createElement("a"),s=window.URL.createObjectURL(t),n=window.decodeURI(e.headers.get("Content-Disposition").split(/=(.*?);/)[1],"UTF-8")||"donloadFile";i.href=s,i.download=n,i.click()})})},frd.util.distinctArray=function(e){return e.filter(function(e,t,i){return i.indexOf(e,0)===t})},frd.util.findElement=function(e,t,i){var s="string"==typeof t?function(e){return ecui.dom.hasClass(e,t)}:t;for(i&&(e=ecui.dom.parent(e));e!==document.body&&null!==e;e=ecui.dom.parent(e))if(s(e))return e;return null},frd.util.parseArrayParameters=function(e,t){return t=t||"id","string"==typeof e?e.split(","):e instanceof Array?e.map(function(e){return"string"==typeof e||"number"==typeof e?String(e):"object"==typeof e&&String(e[t])||""}).filter(function(e){return!!e}):[]},frd.FrameSelectionView=_interface("$FrameSelectionView",{constructor:function(e){this._isDrag=!1,this._isPendingDrag=!1,this._startPosition=null,this._endPosition=null,this._oPosition=null,"static"===ecui.dom.getStyle(e,"position")&&(e.style.position="relative"),this._eMaskView=ecui.dom.create({style:"display:none;position: absolute;border: 1px solid #C3D3FF;box-sizing: border-box;pointer-events: none;background-color: rgba(61,112,251,0.05);border-radius: 1px;"}),e.appendChild(this._eMaskView)},$mousedown:function(e){this.$FrameSelectionView.$mousedown.call(this,e);var t=this.getMain().getBoundingClientRect();this._oPosition={x:t.x,y:t.y,width:t.width,height:t.height},this.isBeyondBorder(e)?this.endDragEvent():(this._isPendingDrag=!0,this._startPosition=this._endPosition=this._convert2RelativeCo(e),this._refreshMaskView())},$mousemove:function(e){this.$FrameSelectionView.$mousemove.call(this,e),(this._isDrag||this._isPendingDrag)&&(this.isBeyondBorder(e)?this.endDragEvent():(this.isDragEvent(e)&&(this._isDrag=!0,this._eMaskView.style.display=""),this._endPosition=this._convert2RelativeCo(e),this._refreshMaskView()))},$mouseout:function(e){this.$FrameSelectionView.$mouseout.call(this,e),this._isDrag&&(this._endPosition=this._convert2RelativeCo(e),this._refreshMaskView(),this.dragViewEnd&&this.dragViewEnd(this._startPosition,this._endPosition),this.endDragEvent())},$mouseup:function(e){this.$FrameSelectionView.$mouseup.call(this,e),this._isPendingDrag=!1,this._isDrag&&(this.isBeyondBorder(e)?this.endDragEvent():(e.gestureType="drag",this._endPosition=this._convert2RelativeCo(e),this._refreshMaskView(),this.dragViewEnd&&this.dragViewEnd(this._startPosition,this._endPosition),this.endDragEvent()))},endDragEvent:function(){this._startPosition=this._endPosition=this._oPosition=null,this._isDrag=this._isPendingDrag=!1,this._eMaskView.style.display="none"},isDragEvent:function(e){var t=this._convert2RelativeCo(e),i=this._startPosition;return Math.abs(t.x-i.x)>2||Math.abs(t.y-i.y)>2},isBeyondBorder:function(e){var t=this._convert2RelativeCo(e);return t.x<0||t.y<0},_convert2RelativeCo:function(e){var t=this._oPosition.x,i=this._oPosition.y;return{a_x:e.clientX,a_y:e.clientY,x:e.clientX-t,y:e.clientY-i}},_refreshMaskView:function(){var e=Math.min(this._startPosition.x,this._endPosition.x),t=Math.min(this._startPosition.y,this._endPosition.y),i=Math.abs(this._startPosition.x-this._endPosition.x),s=Math.abs(this._startPosition.y-this._endPosition.y);this._eMaskView.style.left=e+"px",this._eMaskView.style.top=t+"px",this._eMaskView.style.width=i+"px",this._eMaskView.style.height=s+"px"}}),frd.FormClear=_interface("$FormClear",{constructor:function(e){ecui.dom.insertHTML(e,"BEFOREEND",'<span class="frd-close-icon"></span>'),this._uClear=ecui.$fastCreate(this.Clear,ecui.dom.last(e),this)},Clear:ecui.inherits(ecui.ui.Control,{onclick:function(e){this.getParent().setValue(""),e.preventDefault(),e.stopPropagation()}})}),frd.CustomText=ecui.inherits(ecui.ui.Control,"ui-custom-text",function(e,t){ecui.ui.Control.call(this,e,t),this._uLabel=ecui.$fastCreate(this.Label,ecui.dom.first(e),this),t.labelLayout?ecui.dom.addClass(e,"ui-custom-text-"+t.labelLayout):this._uLabel.hide(),this._uTextView=ecui.$fastCreate(this.TextView,ecui.dom.last(e),this,{value:t.value,name:t.name,regexp:t.regexp,frontIcon:t.frontIcon,placeholder:t.placeholder})},{Label:ecui.inherits(ecui.ui.Control,{}),TextView:ecui.inherits(ecui.ui.Control,function(e,t){ecui.ui.Control.call(this,e,t),t.frontIcon&&(this._eFontIcon=ecui.dom.create("DIV",{className:"ui-custom-text-font-icon"}),e.appendChild(this._eFontIcon),this._eFontIcon.style.background="url("+t.frontIcon+") no-repeat center center",this._uFrontIcon=ecui.$fastCreate(this.FrontIcon,this._eFontIcon,this)),this._eText=ecui.dom.create("DIV",{className:"ui-custom-text-input"}),e.appendChild(this._eText),this._uText=ecui.$fastCreate(this.Text,this._eText,this,{value:t.value,name:t.name,regexp:t.regexp,placeholder:t.placeholder}),this._eEndIcon=ecui.dom.create("DIV",{className:"ui-custom-text-end-icon"}),e.appendChild(this._eEndIcon),this._uEndIcon=ecui.$fastCreate(this.EndIcon,this._eEndIcon,this),this._eError=ecui.dom.create("DIV",{className:"ui-custom-text-error ui-hide"}),e.appendChild(this._eError),this._uError=ecui.$fastCreate(this.ErrorInfo,this._eError,this),this._eText.style.width=e.clientWidth-(this._eFontIcon?this._eFontIcon.clientWidth+this._eEndIcon.clientWidth:this._eEndIcon.clientWidth)+"px"},{FrontIcon:ecui.inherits(ecui.ui.Control,{}),Text:ecui.inherits(ecui.ui.Text,{$input:function(e){ecui.ui.Text.prototype.$input.call(this,e);var t=this.getParent()._uEndIcon;this.getValue()?(t.alterStatus("+clear"),t.clickable=!0):(t.alterStatus("-clear"),t.clickable=!1)}}),EndIcon:ecui.inherits(ecui.ui.Control,{$click:function(e){ecui.ui.Control.prototype.$click.call(this,e),this.clickable&&(this.getParent()._uText.setValue(""),this.alterStatus("-clear"),this.clickable=!1)}}),ErrorInfo:ecui.inherits(ecui.ui.Control,{}),$blur:function(){this._eEndIcon.clickable=!1,ecui.ui.Control.prototype.$blur.call(this),this._uText._oRegExp&&(ecui.dispatchEvent(this._uText,"validate")?this.getParent().alterStatus("+success"):(this.getParent().alterStatus("+error"),this._uError.setContent("内容不能为空"),this._uError.show()))},$focus:function(){ecui.ui.Control.prototype.$focus.call(this),this.getParent().alterStatus("-success"),this.getParent().alterStatus("-error"),this._uError.hide()}})}),frd.CustomTextArea=ecui.inherits(ecui.ui.Text,"ui-input-textarea",function(e,t){ecui.ui.Text.call(this,e,t),this._bAutoDraw=t.draw,this._bAutoDraw&&ecui.dom.addClass(e,"ui-input-textarea-draw")},{onkeyup:function(){this.autoDraw()},$cache:function(e){this.autoDraw(),ecui.ui.Text.prototype.$cache.call(this,e)},autoDraw:function(){if(this._bAutoDraw){var e=this.getMain().getElementsByTagName("TEXTAREA")[0];e.style.overflow="hidden",e.style.height="30px",e.scrollTop=0,e.style.height=e.scrollHeight+"px",this.getMain().style.height=e.scrollHeight+"px"}}}),frd.SearchText=ecui.inherits(ecui.ui.Text,"frd-search-text",function(e,t){ecui.ui.Text.call(this,e,t),this._eInput.setAttribute("autocomplete","off"),ecui.dom.addClass(this._eInput,"frd-search-input");var i=ecui.dom.create("DIV",{innerHTML:'<span class="frd-glass-icon"></span>',className:"frd-search-text-attachment"});e.appendChild(i),this._uSearch=ecui.$fastCreate(this.SearchItem,i,this,{focusable:!0})},{SearchItem:ecui.inherits(ecui.ui.Control,{onclick:function(e){e.preventDefault(),e.stopPropagation(),ecui.dispatchEvent(this.getParent(),"search",e)}}),$keydown:function(e){ecui.ui.Text.prototype.$keydown.call(this,e),13===e.which&&(ecui.dispatchEvent(this,"search",e),e.exit())},onsearch:function(){}}),frd.CommonTreeView=ecui.inherits(ecui.ui.TreeView,"frd-common-tree-view",function(e,t){ecui.ui.TreeView.call(this,e,t)},{setSelectItem:function(e){for(var t,i=[this];0!==i.length&&(this===(t=i.shift())||!e(t));)t._aChildren&&i.push.apply(i,t._aChildren),t=null;if(null!==t){var s=t.getParent();s&&s.isCollapsed&&s.isCollapsed()&&ecui.dispatchEvent(s,"arrowclick"),this.getRoot().setSelected(t)}},$click:function(e){ecui.ui.Control.prototype.$click.call(this,e);for(var t=e.getControl();t!==this;t=t.getParent())if(t instanceof ecui.ui.TreeView)return;"true"!==this.getMain().getAttribute("disabled")&&ecui.dispatchEvent(this,"nodeclick",e)},onarrowclick:function(){this._eContainer&&(this.isCollapsed()?(this.expand(),ecui.dispatchEvent(this,"expand")):(this.collapse(),ecui.dispatchEvent(this,"collapse")))},ArrowBtn:ecui.inherits(ecui.ui.Control,function(e,t){ecui.ui.Control.call(this,e,t)},{onclick:function(e){var t=frd.util.findControl(this.getMain(),frd.CommonTreeView);t&&ecui.dispatchEvent(t,"arrowclick",e),e.stopPropagation()}}),TipView:ecui.inherits(ecui.ui.Control,function(e,t){t.ext={dynamictip:"right"},ecui.ui.Control.call(this,e,t)},{refeshStatus:function(){var e=this.getMain();ecui.dom.first(this.getMain()).offsetHeight>e.offsetHeight?this.isCanShow=!0:this.isCanShow=!1},onready:function(){this.refeshStatus()}}),setSelected:function(e){var t=this.$SelectedData.value;if(ecui.ui.TreeView.prototype.setSelected.call(this,e),t&&e!==t)for(t=t.getParent();t&&t.getRoot&&t!==t.getRoot();)t.alterStatus("-pselected"),t=t.getParent();for(e=e&&e.getParent();e&&e.getRoot&&e!==e.getRoot();)e.alterStatus("+pselected"),e=e.getParent()}}),frd.SearchTreeSelect=ecui.inherits(ecui.ui.InputControl,"ui-search-tree-select",function(e,t){var i=ecui.dom.last(e),s=ecui.dom.create("div");s.appendChild(i),ecui.ui.InputControl.call(this,e,t);var n=t.placeholder||"请选择";if(this._eText=ecui.dom.create("div",{className:this.getUnitClass(Object.getPrototypeOf(this).constructor,"text"),innerHTML:n}),e.appendChild(this._eText),this._uText=ecui.$fastCreate(this.TextControl,this._eText,this,{placeholder:n}),this._uClear=ecui.$fastCreate(this.Clear,e.appendChild(ecui.dom.create("DIV",{className:this.getUnitClass(Object.getPrototypeOf(this).constructor,"clear")})),this),!1!==t.search){ecui.dom.insertHTML(s,"afterBegin",'<div class="ui-tree-search"></div>');var a=ecui.dom.first(s);a.className+=" ui-text ui-input",this._uTreeSearch=ecui.$fastCreate(this.TreeSearch,a,this)}this._uTreeView=ecui.$fastCreate(this.TreeView,i,this,{primary:" ui-treeview",subject:t.subject}),s.className=this.getUnitClass(Object.getPrototypeOf(this).constructor,"options")+" ui-popup ui-hide",this._uOptions=ecui.$fastCreate(this.Options,s,this,{focusable:!1}),this.setPopup(this._uOptions),t.value&&this.setValue(t.value)},{TextControl:ecui.inherits(ecui.ui.Control,function(e,t){ecui.ui.Control.call(this,e,t),this._sPlaceholder=t.placeholder},{setSelectText:function(e){this.getMain().innerHTML=e||this._sPlaceholder}}),Clear:ecui.inherits(ecui.ui.Control,{$click:function(e){ecui.ui.Control.prototype.$click.call(this,e),this.getParent().clear(),e.stopPropagation()}}),Options:ecui.inherits(ecui.ui.Control,{}),TreeSearch:ecui.inherits(ecui.ui.Text,{$input:function(e){ecui.ui.Text.prototype.$input.call(this,e),this.getParent().searchTree(this.getValue())}}),TreeView:ecui.inherits(ecui.ui.TreeView,function(e,t){if(Object.assign(t,{collapsed:!1}),ecui.ui.TreeView.call(this,e,t),this._eContainer){e=this.getMain(),t=ecui.getOptions(e)||t,ecui.dom.insertHTML(e,"afterBegin",'<div class="ui-collapse"></div>');var i=ecui.dom.first(e);this._cCollapse=ecui.$fastCreate(this.Collapse,i,this)}else ecui.dom.addClass(e,"ui-treeview-children-last");this._sValue=t.value,this._sText=t.text},{Collapse:ecui.inherits(ecui.ui.Control,"ui-collapse",{}),$click:function(e){ecui.ui.Control.prototype.$click.call(this,e);for(var t=e.getControl();t!==this;t=t.getParent())if(t instanceof ecui.ui.TreeView)return;e.getControl()instanceof this.Collapse?ecui.dispatchEvent(this,"nodeclick",e):(this.getRoot().setSelected(this),ecui.dispatchEvent(this.getRoot().getParent(),"nodeclick",e))},getValue:function(){return this._sValue},getContent:function(){return this._sText||this.getBody().innerText},getSelectData:function(){return this._sValue?{value:this._sValue,text:this.getContent()}:null}}),$nodeclick:function(){this._uOptions.hide();var e=this._uTreeView.getSelected();this.setValue(e.getSelectData())},clear:function(){this.setValue(""),this._uTreeView.setSelected()},init:function(){this.getValue()||(this.setValue(""),this._uText.setSelectText())},searchTree:function(e){this.queryTree(this._uTreeView,e)},queryTree:function(e,t){t?function t(i,s,n){var a=!1,r=i._aChildren;return a=r&&r.length>0?r.map(function(e){return t(e,s,n)}).some(function(e){return e}):n(i),e===i||(a?i.show():i.hide(),a)}(e,t,function(e){return-1!==e.getContent().indexOf(t)}):frd.util.traverseTree(e,function(e){e.show()})},findItem:function(e,t){for(var i,s=e,n=[e];0!==n.length&&(s===(i=n.shift())||!t(i));)i._aChildren&&n.push.apply(n,i._aChildren),i=null;return i},setValue:function(e){if(e)if(ecui.dom.removeClass(this.getMain(),"ui-placeholder"),e instanceof Object){var t=e.value,i=e.text;this._eInput.value=t,this._uText.setSelectText(i)}else{var s=this.findItem(this._uTreeView,function(t){return t.getValue()===e});s&&(this._uTreeView.setSelected(s),this.$nodeclick())}else this._eInput.value="",this._uText.setSelectText(""),ecui.dom.addClass(this.getMain(),"ui-placeholder")},isPopupShow:function(){return this._uOptions.isShow()}},ecui.ui.Popup),frd.MultiSearchTreeSelect=ecui.inherits(frd.SearchTreeSelect,"ui-multi-search-tree-select",[function(e,t){this._allItems=[],this.initAllItems(this._uTreeView),t.value&&this.initSelectValue(t.value)},function(e,t){frd.SearchTreeSelect.call(this,e,t),this._sPlaceholder=t.placeholder||"请选择选项",this._eText.innerHTML='<div class="ui-placeholder-item-text" style="display: inline-block;" >'+this._sPlaceholder+"</div>"}],{initSelectValue:function(e){if(this._allItems){var t=e.split(",");this._allItems.forEach(function(e){e.setChecked(!1),t.includes(e.getValue())&&e.setChecked(!0)}),this.changeOption()}},initAllItems:function(e){var t=e.getChildren();t&&(0!==t.length?t.forEach(function(e){this.initAllItems(e)},this):this._allItems.push(e))},_oItems:[],_oValues:[],TreeView:ecui.inherits(ecui.ui.TreeView,"ui-checkbox-tree",[function(e,t){if(this._uCheckbox=ecui.$fastCreate(this.Checkbox,e.insertBefore(ecui.dom.create({className:ecui.ui.Checkbox.CLASS}),e.firstChild),this,Object.assign({},t,{id:void 0,primary:""})),t.subject&&this.getChildren().forEach(function(e){e._uCheckbox.setSubject(this._uCheckbox)},this),this._eContainer){ecui.dom.addClass(e,"ui-p-tree-view"),e=this.getMain(),t=ecui.getOptions(e)||t,ecui.dom.insertHTML(e,"afterBegin",'<div class="ui-collapse"></div>');var i=ecui.dom.first(e);this._cCollapse=ecui.$fastCreate(this.Collapse,i,this)}else ecui.dom.addClass(e,"ui-treeview-children-last");this._sValue=t.value,this._sText=t.text},function(e,t){Object.assign(t,{collapsed:!1}),ecui.ui.TreeView.call(this,e,t),this._checkStatus=!1}],{Collapse:ecui.inherits(ecui.ui.Control,"ui-collapse",{}),Checkbox:ecui.inherits(ecui.ui.Checkbox,{$click:function(e){ecui.ui.Checkbox.prototype.$click.call(this,e),e.stopPropagation()},setChecked:function(e){ecui.ui.Checkbox.prototype.setChecked.call(this,e),this.getParent()._checkStatus=this.isChecked()},onchange:function(){var e=this.getParent();e.getRoot().getParent().changeOption(e.getValue(),e.getContent(),this.isChecked())}}),getContent:function(){return this._sText||this.getBody().innerText},getValue:function(){return this._sValue},isChecked:function(){return this._uCheckbox.isChecked()},setChecked:function(e){this._uCheckbox.setChecked(e)},getChecked:function(){var e=this.isChecked()?[this]:[];return this.getChildren().forEach(function(t){e=e.concat(t.getChecked())}),e}}),Option:ecui.inherits(ecui.ui.Control,function(e,t){ecui.ui.Control.call(this,e,t),this._uClose=ecui.$fastCreate(this.Close,e.appendChild(ecui.dom.create("DIV",{className:"ui-tree-select-item-close"})),this),this._sValue=t.value,this._sText=t.text},{Close:ecui.inherits(ecui.ui.Control,{onclick:function(){this.getParent().getParent().getParent().removeItem(this.getParent())}}),getValue:function(){return this._sValue},getText:function(){return this._sText}}),changeOption:function(){this._oItems.forEach(function(e){ecui.dom.remove(e.getMain()),e.dispose()}),this._oItems=[],this._allItems.filter(function(e){return e._checkStatus}).map(function(e){var t=ecui.dom.create({className:"ui-tree-select-item",innerHTML:e.getContent()});this._oItems.push(ecui.$fastCreate(this.Option,t,this._uText,{value:e.getValue(),text:e.getContent()})),this._eText.appendChild(t)}.bind(this)),this.repaint(),this.setValue(this.getFormValue()),this.updatePosition()},clear:function(){var e=this._oItems.map(function(e){return e.getValue()});!function t(i,s){e.indexOf(i.getValue())>=-1&&i._uCheckbox.setChecked(s),i._aChildren.forEach(function(e){t(e,s)})}(this._uTreeView,!1),this._oItems=[],ecui.dispose(this._eText),this._eText.innerHTML='<div class="ui-placeholder-item-text" style="display: inline-block;" >'+this._sPlaceholder+"</div>",!this.isHidden()&&this.repaint(),this.updatePosition()},getFormValue:function(){return this._oItems.map(function(e){return e.getValue()})},isHidden:function(){return null===this.getMain().offsetParent},init:function(){this.setValue(this.getFormValue())},setValue:function(e){e?e instanceof Array?this._eInput.value=e.join(","):this.initSelectValue(e):(this._eInput.value="",this.clear()),this._eInput.value?ecui.dom.first(this._eText)&&(ecui.dom.first(this._eText).style.display="none"):ecui.dom.first(this._eText)&&(ecui.dom.first(this._eText).style.display="inline-block")},tipViewChange:function(e){},removeItem:function(e){var t=this._oItems.indexOf(e),i=e.getValue();this._oItems.splice(t,1),ecui.dom.remove(e.getMain()),e.dispose(),this.repaint(),this.setValue(this.getFormValue());var s=!1;!function e(t,n){if(t.getValue()===i)return t._uCheckbox.setChecked(n),void(s=!0);s||t._aChildren.forEach(function(t){e(t,n)})}(this._uTreeView,!1),this.updatePosition()}}),frd.MultipleInputGroupPart=ecui.inherits(ecui.ui.Control,"frd-multiple-input-group-part",function(e,t){ecui.ui.Control.call(this,e,t),this.isCanInput=!!t.isCanInput,e.append(ecui.dom.create("div",{className:"frd-input-wrap",autocomplete:"off"})),this._uInput=ecui.$fastCreate(this.Input,ecui.dom.last(e),this,{isCanInput:this.isCanInput}),this._aGroupData=[],this._sPlaceholder=t.placeholder||"请输入",this.updateInputState()},{templateStr:'\x3c!-- for: ${items} as ${item} --\x3e                     <div class="${classStr}">                         <span class="item-title">${item.name}</span>                         <span class="close-icon ${closeClassStr}" data-path="${item.path}"></span>                     </div>                 \x3c!-- /for --\x3e',closeClassStr:"frd-group-wrap-item-close-icon",Input:ecui.inherits(ecui.ui.InputControl,function(e,t){ecui.ui.InputControl.call(this,e,t),this.isCanInput=!!t.isCanInput,t.isCanInput||(ecui.dom.addClass(this._eInput,"ui-hide"),this._eText=ecui.dom.create("span",{className:"frd-input-wrap"}),e.append(this._eText))},{oninput:function(){this.updateInputWidth(),this.getParent().getParent()&&ecui.dispatchEvent(this.getParent().getParent(),"inputChange",{value:this.getValue()})},onkeydown:function(e){8===e.which&&0===this.getValue().length&&this.getParent().getParent()&&ecui.dispatchEvent(this.getParent().getParent(),"delete")},setPlaceholder:function(e){this.isCanInput?this._eInput.placeholder=e:this._eText.innerText=e},resetValue:function(){this.isCanInput&&(this._eInput.value="")},clearValue:function(){this._eInput.value="",this.oninput()},setFocus:function(){this.isCanInput&&this._eInput.focus()},updateInputWidth:function(){this._needUpdate&&(this.getMain().style.width=12*this.getValue().length+20+"px")}}),$click:function(e){this.isCanInput&&this.getParent()&&this.getParent().$getSection("Options").isShow()?e.stopPropagation():ecui.ui.Control.prototype.$click.call(this,e),ecui.dom.hasClass(e.target,this.closeClassStr)&&(this.getParent()&&ecui.dispatchEvent(this.getParent(),"closeClick",{path:e.target.dataset.path}),!this.isFocused())||setTimeout(function(){this._uInput.setFocus()}.bind(this),0)},getValue:function(){return this._uInput.getValue()},updateInputState:function(e){e&&0!==e.length?(this._uInput._needUpdate=!0,this._uInput.setPlaceholder(""),this._uInput.updateInputWidth()):(this._uInput._needUpdate=!1,this._uInput.getMain().style.width="100%",this._uInput.setPlaceholder(this._sPlaceholder))},clearGroup:function(){ecui.dom.children(this.getMain()).forEach(function(e){this._uInput.getMain()!==e&&ecui.dom.remove(e)},this)},setData:function(e,t){var i=Array.prototype.slice.call(this.getMain().querySelectorAll(".frd-group-wrap-item-close-icon")).reduce(function(e,t){return e+t.dataset.path},""),s=e.reduce(function(e,t){return e+t.path},"");this.clearGroup(),e.sort(function(e,t){var s=i.indexOf(e.path);s=-1===s?999999:s;var n=i.indexOf(t.path);return s-(n=-1===n?999999:n)}),this.updateInputState(e),ecui.dom.insertHTML(this.getMain(),"AFTERBEGIN",frd.util.compileTemplate(this.templateStr,{items:e,classStr:"frd-group-wrap-item",closeClassStr:this.closeClassStr})),i===s||t||this.getParent()&&ecui.dispatchEvent(this.getParent(),"change")},onblur:function(){this._uInput.clearValue()}}),frd.NewTreeView=ecui.inherits(ecui.ui.Control,"frd-new-tree-view",function(e,t){this._oData=t.data||[],ecui.ui.Control.call(this,e,t),this._newInitTreeArray(this._oData),t.value&&this.setInitValue(t.value),this.render()},{KEYWORD:"id",setItemHideStatus:function(e,t){2!==e.isHide&&3!==e.isHide&&(e.isHide=t)},getItemHideStatus:function(e){return 3===e.isHide||1===e.isHide?1:0},refreshTreeViewWithData:function(e,t){this._oData=e||[],this._newInitTreeArray(this._oData),t&&this.setInitValue(t),this.render(),this.getParent()&&ecui.dispatchEvent(this.getParent(),"optionsChange")},setValue:function(e){this.setInitValue(e)},setInitValue:function(e){var t=this.generateSelectData(e);this.resetSelectData(t),setTimeout(function(){this.getParent()&&ecui.dispatchEvent(this.getParent(),"optionsChange")}.bind(this),0),this.render()},generateSelectData:function(e){var t=frd.util.parseArrayParameters(e,this.KEYWORD),i=[],s=this.KEYWORD;return frd.util.traverseTree(this._oData,function(e){t.includes(String(e[s]))&&i.push(e)},"children"),i},_newInitTreeArray:function(e,t){t=t?t+".":"",e.forEach(function(e,i){e.path=t+i,e.checked=e.checked?e.checked:0,this.setItemHideStatus(e,1),e.children&&e.children.length>0?(e.expanded=0,e.isLoad=!1,this._newInitTreeArray(e.children,e.path)):e.isLeafNode=!0},this)},templateStr:'\x3c!-- target: _commonNewTreeView --\x3e                     \x3c!-- for: ${items} as ${item} --\x3e                     <div class="frd-new-tree-item ${showMap[item.isHide]}" data-path="${item.path}">                         <div class="frd-new-tree-item-label ${checkMap[item.checked]} ${arrowMap[item.expanded]}">                             <span class="tree-item-title">${item.name}</span>                             \x3c!-- if: ${item.children} && ${item.children.length} > 0  --\x3e                             <span class="arrow-icon"></span>                             \x3c!-- /if --\x3e                         </div>                         \x3c!-- if: ${item.children} && ${item.children.length} > 0 --\x3e                         <div class="frd-new-tree-item-group ${showMap[item.expanded]}">                             \x3c!-- if: ${item.expanded} === 1 --\x3e                             \x3c!-- use: _commonNewTreeView(items=${item.children}, checkMap=${checkMap}, arrowMap=${arrowMap}, showMap=${showMap}) --\x3e                             \x3c!-- /if --\x3e                         </div>                         \x3c!-- /if --\x3e                     </div>                     \x3c!-- /for --\x3e',checkMap:{0:"",1:"frd-new-tree-item-checked",2:"frd-new-tree-item-part"},arrowMap:{0:"frd-new-tree-item-collapsed",1:"frd-new-tree-item-expanded"},showMap:{0:"ui-hide",1:"",2:"ui-hide",3:""},itemClass:"frd-new-tree-item",labelClass:"frd-new-tree-item-label",groupClass:"frd-new-tree-item-group",generateHtml:function(e){return ecui.esr.getEngine().getRenderer("_commonNewTreeView")?ecui.esr.getEngine().getRenderer("_commonNewTreeView")(e):frd.util.compileTemplate(this.templateStr,e)},render:function(){this.getMain().innerHTML=this.generateHtml({items:this._oData,checkMap:this.checkMap,arrowMap:this.arrowMap,showMap:this.showMap})},synchronizationLoadStatus:function(e){for(var t,i=[e];0!==i.length;)(t=i.shift())._aChildren&&i.push.apply(i,t._aChildren),t.isLoad=1===t.expanded},renderWithPath:function(e,t){var i=this.findCurrentDataWithPath(e);this.synchronizationLoadStatus(i);var s=this.generateHtml({items:[i],checkMap:this.checkMap,arrowMap:this.arrowMap,showMap:this.showMap}),n=ecui.dom.create("div",{innerHTML:s});ecui.dom.parent(t).replaceChild(ecui.dom.first(n),t)},renderClassWithPath:function(e,t){var i=this.findCurrentDataWithPath(e);(t=ecui.dom.first(t))&&(t.className=this.labelClass+" "+this.checkMap[i.checked]+" "+this.arrowMap[i.expanded])},renderChildrenClassWithPath:function(e,t){var i=this.findCurrentDataWithPath(e);1!==ecui.dom.children(t).length&&(t=ecui.dom.last(t))&&(t.className=this.groupClass+" "+this.showMap[i.expanded])},renderParentDomWithPath:function(e,t){for(var i=e.split(".").length-1,s=0;s<i;s++)(t=frd.util.findElement(t,this.itemClass,!0))&&this.renderClassWithPath(t.dataset.path,t)},findCurrentDataWithPath:function(e){return frd.util.findTreeDataByPath(this._oData,e)},onclick:function(e){if(ecui.dom.contain(this.getMain(),e.target)){var t=frd.util.findElement(e.target,this.itemClass);if(t){var i=t.dataset;ecui.dom.hasClass(e.target,"arrow-icon")?this.arrowClick(i.path,t):this.selectClick(i.path,t)}}},queryTree:function(e){this.queryList(this._oData,function(t){return-1!==String(t.name).indexOf(e)}),this.render()},publicSelecClick:function(e){var t=this.getMain().querySelector('[data-path="'+e+'"]');this.selectClick(e,t)},publicGetTargetWithPath:function(e){return this.getMain().querySelector('[data-path="'+e+'"]')},selectClick:function(e,t){var i=this.findCurrentDataWithPath(e);i.checked=1===i.checked?0:1,this.setChildStatus(i,i.checked),this.setParentStatus(i,this._oData),t&&this.renderParentDomWithPath(e,t),t&&this.renderWithPath(e,t),this.getParent()&&ecui.dispatchEvent(this.getParent(),"optionsChange")},arrowClick:function(e,t){var i=this.findCurrentDataWithPath(e);i.expanded=1===i.expanded?0:1,i.isLoad?(this.renderChildrenClassWithPath(e,t),this.renderClassWithPath(e,t)):this.renderWithPath(e,t)},setChildStatus:function(e,t){if(e instanceof Array)e={children:e};else if(!e.children||0===this.getItemHideStatus(e))return;e.children.forEach(function(e){1===this.getItemHideStatus(e)&&(e.checked=t,this.setChildStatus(e,t))},this)},setParentStatus:function(e,t){var i=e.path;if(!i||-1!==i.indexOf(".")){var s,n=i.split(".");for(n.pop();n.length>0;){s=frd.util.findTreeDataByPath(t,n.join("."));var a=this.refreshParentStatus(s);if(n.pop(),0==a)break}}},refreshParentStatus:function(e){if(e.children&&0!==e.children.length){var t=e.children.filter(function(e){return 1===this.getItemHideStatus(e)}.bind(this)),i=t.length,s=t.filter(function(e){return 0!==e.checked}).length,n=t.filter(function(e){return 2===e.checked}).length,a=e.checked;return e.checked=0===s?0:0!==n||s<i?2:1,a!==e.checked}return!0},_getAllSelectTreeData:function(e,t){t.forEach(function(t){0!==t.checked&&(t.children&&0!==t.children.length?this._getAllSelectTreeData(e,t.children):e.push(t))}.bind(this))},_getAllMergeSelectTreeData:function(e,t){t.forEach(function(t){1===t.checked?e.push(t):2===t.checked&&this._getAllMergeSelectTreeData(e,t.children)}.bind(this))},getAllSelectTreeData:function(e){var t=[],i=this._oData,s=JSON.parse(JSON.stringify(i));return this.queryList(s,function(){return!0}),this.refreshAllParentStatus(s,[]),e?this._getAllSelectTreeData(t,s):this._getAllMergeSelectTreeData(t,s),t},refreshAllParentStatus:function(e,t){e.forEach(function(e){e.children&&e.children.length>0&&(this.refreshAllParentStatus(e.children,t),this.refreshParentStatus(e,t))}.bind(this))},queryList:function(e,t){e.forEach(function(e){this.queryTreePostData(e,t)}.bind(this))},queryTreePostData:function(e,t){var i=t(e);return i?this.setTreeDataStatus(e,!i):e.children&&e.children.length>0&&(i=e.children.filter(function(e){return this.queryTreePostData(e,t)}.bind(this)).length>0),this.setShowStatus(e,!i),i},setTreeDataStatus:function(e,t){this.setShowStatus(e,t),e.children&&e.children.length>0&&e.children.forEach(function(e){this.setTreeDataStatus(e,t)}.bind(this))},setShowStatus:function(e,t){this.setItemHideStatus(e,t?0:1)},clearAll:function(){this.setChildStatus(this._oData,0)},selectAll:function(){this.setChildStatus(this._oData,1)},resetSelectData:function(e){var t=this._oData;this.clearAll(),e.forEach(function(e){2===e.isHide?e.checked=0:e.checked=1,this.setChildStatus(e,e.checked),this.setParentStatus(e,t)}.bind(this))},getValue:function(){var e=this.KEYWORD;return this.getAllSelectTreeData().map(function(t){return t[e]})}}),frd.NewMultipleTreeSelect=ecui.inherits(ecui.ui.InputControl,"*frd-new-multi-tree-select",function(e,t){ecui.ui.InputControl.call(this,e,t),ecui.dom.addClass(this._eInput,"ui-hide"),"string"==typeof t.data&&(t.data=JSON.parse(JSON.stringify(ecui.esr.getData(t.data)))),this._oData=t.data||[],e.append(ecui.dom.create("div",{})),this._uInputGroup=ecui.$fastCreate(this.MultipleInputGroupPart,ecui.dom.last(e),this,{focusable:!1,isCanInput:!!t.isCanInput,primary:frd.MultipleInputGroupPart.CLASS,placeholder:t.placeholder,pOptions:t}),e.append(ecui.dom.create("div",{className:this.getUnitClass(frd.NewMultipleTreeSelect,"options")+" ui-hide"})),this._uOptions=ecui.$fastCreate(this.Options,ecui.dom.last(e),this,{focusable:!1,userSelect:!1,data:this._oData,value:t.value,pOptions:t}),this.setPopup(this._uOptions),this.$setBody(this._uOptions.getBody())},{Options:frd.NewTreeView,MultipleInputGroupPart:frd.MultipleInputGroupPart,onoptionsChange:function(){this._uInputGroup.setData(this._uOptions.getAllSelectTreeData());try{this.repaint()}catch(e){}this.updatePosition()},ondelete:function(){var e=this._uOptions.getAllSelectTreeData();e.length>0&&this._uOptions.publicSelecClick(e.pop().path)},oncloseClick:function(e){e.path&&this._uOptions.publicSelecClick(e.path)},oninputChange:function(e){this._uOptions.queryTree(e.value)},getValue:function(){return this._uOptions.getValue()},setValue:function(e){return this._uOptions.setValue(e)}},ecui.ui.Popup),frd.NewMultiSelectOptionsPart=ecui.inherits(ecui.ui.Control,"frd-new-multi-select-options",function(e,t){t.pOptions.keyword&&(this.KEYWORD=t.pOptions.keyword),this._oData=t.data||[],this._newInitTreeArray(this._oData),ecui.ui.Control.call(this,e,t),this.maxCount=t.pOptions.maxCount,this.selectDatas=[],t.value&&this.setInitValue(t.value),this.render()},{KEYWORD:"id",refreshSelectViewWithData:function(e,t){this._oData=e||[],this._newInitTreeArray(this._oData),t&&this.setInitValue(t),this.render(),this.getParent()&&ecui.dispatchEvent(this.getParent(),"optionsChange")},_newInitTreeArray:function(e,t){t=t||"",e.forEach(function(e,i){e.path=t+i,e.checked=e.checked?e.checked:0,e.isHide=1},this)},setValue:function(e){this._oData.forEach(function(e){e.checked=0}),this.setInitValue(e)},setInitValue:function(e){this.selectDatas=this.generateSelectData(e),setTimeout(function(){this.getParent()&&ecui.dispatchEvent(this.getParent(),"optionsChange")}.bind(this),0),this.render()},generateSelectData:function(e){var t=this.KEYWORD;return frd.util.parseArrayParameters(e).map(function(e){return this._oData.find(function(i){return String(i[t])===String(e)&&(i.checked=1,!0)})}.bind(this)).filter(function(e){return!!e})},templateStr:'\x3c!-- for: ${items} as ${item} --\x3e             <div class="${itemClass} ${showMap[item.isHide]} ${checkMap[item.checked]}" data-path="${item.path}">                 <span class="${itemClass}-label">${item.name}</span>             </div>             \x3c!-- /for --\x3e',itemClass:"frd-new-multi-select-options-item",showMap:{0:"ui-hide",1:""},checkMap:{0:"",1:"frd-new-multi-select-options-item-checked"},generateHtml:function(e){return frd.util.compileTemplate(this.templateStr,e)},render:function(){this.getMain().innerHTML=this.generateHtml({items:this._oData,itemClass:this.itemClass,checkMap:this.checkMap,showMap:this.showMap})},renderClassWithPath:function(e,t){var i=this.findCurrentDataWithPath(e);t&&(t.className=this.itemClass+" "+this.showMap[i.isHide]+" "+this.checkMap[i.checked])},findCurrentDataWithPath:function(e){return this._oData.find(function(t){return t.path===e})},onclick:function(e){if(ecui.dom.contain(this.getMain(),e.target)){var t=frd.util.findElement(e.target,this.itemClass);if(t){var i=t.dataset;this.selectClick(i.path,t)}}},queryTree:function(e){this.queryList(this._oData,function(t){return-1!==String(t.name).indexOf(e)}),this.render()},publicSelecClick:function(e){var t=this.getMain().querySelector('[data-path="'+e+'"]');t&&this.selectClick(e,t)},selectClick:function(e,t){var i=this.findCurrentDataWithPath(e);if(this.maxCount&&(this.getAllSelectTreeData(!0).length>=this.maxCount&&0===i.checked))return;i.checked=1===i.checked?0:1,1===i.checked?this.selectDatas.push(i):this.selectDatas=this.selectDatas.filter(function(e){return 1===e.checked}),this.renderClassWithPath(e,t),this.getParent()&&ecui.dispatchEvent(this.getParent(),"optionsChange")},getAllSelectTreeData:function(){return this.selectDatas},queryList:function(e,t){e.forEach(function(e){e.isHide=t(e)?1:0})},getValue:function(){var e=this.KEYWORD;return this.getAllSelectTreeData().map(function(t){return t[e]})}}),frd.NewMultipleSelect=ecui.inherits(ecui.ui.InputControl,"*frd-new-multi-select",function(e,t){ecui.ui.InputControl.call(this,e,t),ecui.dom.addClass(this._eInput,"ui-hide"),"string"==typeof t.data&&(t.data=JSON.parse(JSON.stringify(ecui.esr.getData(t.data)))),this._oData=t.data||[],e.append(ecui.dom.create("div",{})),this._uInputGroup=ecui.$fastCreate(this.MultipleInputGroupPart,ecui.dom.last(e),this,{focusable:!1,isCanInput:!!t.isCanInput,primary:this.MultipleInputGroupPart.CLASS,pOptions:t}),e.append(ecui.dom.create("div",{className:this.Options.CLASS+" ui-hide"})),this._uOptions=ecui.$fastCreate(this.Options,ecui.dom.last(e),this,{focusable:!1,userSelect:!1,data:this._oData,value:t.value,pOptions:t}),this.setPopup(this._uOptions),this.$setBody(this._uOptions.getBody())},{Options:frd.NewMultiSelectOptionsPart,MultipleInputGroupPart:frd.MultipleInputGroupPart,onoptionsChange:function(){this._uInputGroup.setData(this._uOptions.getAllSelectTreeData(),this.noTriggerChange);try{this.repaint()}catch(e){}this.updatePosition()},ondelete:function(){var e=this._uOptions.getAllSelectTreeData();e.length>0&&this._uOptions.publicSelecClick(e.pop().path)},oncloseClick:function(e){e.path&&this._uOptions.publicSelecClick(e.path)},oninputChange:function(e){this._uOptions.queryTree(e.value)},getValue:function(){return this._uOptions.getValue()},setValue:function(e){return this.noTriggerChange=!0,this._uOptions.setValue(e),this.noTriggerChange=!1,!0},refreshSelectViewWithData:function(e,t){return this._uOptions.refreshSelectViewWithData(e,t)}},ecui.ui.Popup),frd.CommonSelectTree=ecui.inherits(ecui.ui.TreeView,"frd-common-select-tree",function(e,t){ecui.ui.TreeView.call(this,e,t),t.data&&t.data instanceof Array?(this._oData=t.data,this._sPath="0"):(this._oData=t.data,this._sPath=t.data.path)},{refreshAllSelectStatus:function(){},allChangeData:function(e){e.filter(function(e){return e.isLeafNode})},publicSelecClick:function(e){var t=ecui.dom.parent(this.getRoot().getMain()).querySelector('[data-path="'+e+'"]');t&&t.getControl&&t.getControl().onclick()},getRootData:function(){return this.getRoot()._oData},findCurrentData:function(){if(this._oCurrentData)return this._oCurrentData;var e=this.getRootData();return this._oCurrentData=frd.util.findTreeDataByPath(e,this._sPath),this._oCurrentData},onarrowclick:function(){this._eContainer&&(this.isCollapsed()?(this.expand(),ecui.dispatchEvent(this,"expand")):(this.collapse(),ecui.dispatchEvent(this,"collapse")))},ArrowBtn:ecui.inherits(ecui.ui.Control,function(e,t){ecui.ui.Control.call(this,e,t)},{onclick:function(e){var t=frd.util.findControl(this.getMain(),frd.CommonSelectTree);t&&ecui.dispatchEvent(t,"arrowclick",e),e.stopPropagation()}}),CellSelectBtn:ecui.inherits(ecui.ui.Control,function(e,t){ecui.ui.Control.call(this,e,t)},{onclick:function(e){var t=frd.util.findControl(this.getMain(),frd.CommonSelectTree);t.getRoot().notEdit||t.changeStatus(),e&&e.stopPropagation()}}),NameBtn:ecui.inherits(ecui.ui.Control,function(e,t){ecui.ui.Control.call(this,e,t)},{onclick:function(e){var t=frd.util.findControl(this.getMain(),frd.CommonSelectTree);t&&ecui.dispatchEvent(t,"arrowclick",e),e.stopPropagation()}}),$nodeclick:function(e){e.stopPropagation()},changeStatus:function(){var e=[];this.refreshData(e),this.refreshNodeDom(e);var t=frd.util.findControl(this.getMain(),frd.MultipleChoicePop);t&&t.changeTreeStatus&&t.changeTreeStatus(this)},_getAllSelectTreeData:function(e,t){t.forEach(function(t){0!==t.checked&&(t.children&&0!==t.children.length?this._getAllSelectTreeData(e,t.children):e.push(t))}.bind(this))},_getAllMergeSelectTreeData:function(e,t){t.forEach(function(t){1===t.checked?e.push(t):2===t.checked&&this._getAllMergeSelectTreeData(e,t.children)}.bind(this))},getAllSelectTreeData:function(e){var t=[],i=this.getRootData(),s=JSON.parse(JSON.stringify(i));return this.queryList(s,function(){return!0}),this.refreshAllParentStatus(s,[]),e?this._getAllSelectTreeData(t,s):this._getAllMergeSelectTreeData(t,s),t},refreshData:function(e){var t=this.findCurrentData();this.nodeStatusChange(e,t),this.setChildStatus(e,t,t.checked),this.setParentStatus(e,t,this.getRootData()),this.getRoot().allChangeData(e)},nodeStatusChange:function(e,t){t.checked=1===t.checked?0:1,e.push(t)},_nodeStatusChangeTo:function(e,t,i){t.checked!==i&&(e.push(t),t.checked=i)},setChildStatus:function(e,t,i){if(t instanceof Array)t={children:t};else if(!t.children||t.isHide)return;t.children.forEach(function(t){t.isHide||(this._nodeStatusChangeTo(e,t,i),this.setChildStatus(e,t,i))},this)},refreshParentStatus:function(e,t){if(e.children&&0!==e.children.length){var i=e.children.filter(function(e){return!e.isHide}),s=i.length,n=i.filter(function(e){return 0!==e.checked}).length,a=i.filter(function(e){return 2===e.checked}).length,r=e.checked;return e.checked=0===n?0:0!==a||n<s?2:1,r!==e.checked&&(t.push(e),!0)}return!0},refreshAllParentStatus:function(e,t){e.forEach(function(e){e.children&&e.children.length>0&&(this.refreshAllParentStatus(e.children,t),this.refreshParentStatus(e,t))}.bind(this))},setParentStatus:function(e,t,i){var s=t.path;if(!s||-1!==s.indexOf(".")){var n,a=s.split(".");for(a.pop();a.length>0;){n=frd.util.findTreeDataByPath(i,a.join("."));var r=this.refreshParentStatus(n,e);if(a.pop(),0==r)break}}},refreshNodeDom:function(e){e.forEach(function(e){this._refreshNodeStatusWithData(e)}.bind(this))},_refreshNodeStatusWithData:function(e){var t=e.path,i=this.getRoot();t.split(".").forEach(function(e){i=i._aChildren[e]}),i.refreshNodeStatus()},refreshNodeStatus:function(){var e=this.findCurrentData();if(e.isHide)ecui.dom.addClass(this._eMain,"ui-hide");else{ecui.dom.removeClass(this._eMain,"ui-hide"),this.alterStatus("-checked"),this.alterStatus("-part");var t=e.checked;0===t||(2===t?this.alterStatus("+part"):this.alterStatus("+checked"))}},queryTree:function(e){this.showStatusNodes=[],this.queryList(this.getRootData(),function(t){return-1!==String(t.name).indexOf(e)}),this.refreshAllParentStatus(this.getRootData(),this.showStatusNodes),this.refreshNodeDom(this.showStatusNodes),this.refreshAllSelectStatus()},queryList:function(e,t){e.forEach(function(e){this.queryTreePostData(e,t)}.bind(this))},queryTreePostData:function(e,t){var i=t(e);return i?this.setTreeDataStatus(e,!i):e.children&&e.children.length>0&&(i=e.children.filter(function(e){return this.queryTreePostData(e,t)}.bind(this)).length>0),this.setShowStatus(e,!i),i},setTreeDataStatus:function(e,t){this.setShowStatus(e,t),e.children&&e.children.length>0&&e.children.forEach(function(e){this.setTreeDataStatus(e,t)}.bind(this))},setShowStatus:function(e,t){!!e.isHide!=!!t&&this.showStatusNodes&&this.showStatusNodes.push(e),e.isHide=t},_setAllStatus:function(e){var t=this.getRootData().filter(function(e){return!e.isHide}),i=[];this.setChildStatus(i,t,e),this.refreshNodeDom(i),this.getRoot().allChangeData(i),this.refreshAllSelectStatus()},clearAll:function(){this._setAllStatus(0)},selectAll:function(){this._setAllStatus(1)},resetSelectData:function(e){var t,i=this.getRootData();this.clearAll();var s=[];e.forEach(function(e){(t=frd.util.findTreeDataByPath(i,e.path)).checked=1,this.setChildStatus(s,t,t.checked),this.setParentStatus(s,t,this.getRootData()),s.push(t)}.bind(this)),this.refreshNodeDom(s)}}),frd.MultipleChoicePop=ecui.inherits(ecui.ui.Control,function(e,t){ecui.ui.Control.call(this,e,t),this.isSearching=!1},{init:function(e){ecui.ui.Control.prototype.init.call(this,e);var t=this.getParent();ecui.util.timer(function(){t&&t.initSuccess&&t.initSuccess()},300)},SelectTree:ecui.inherits(frd.CommonSelectTree,function(e,t){frd.CommonSelectTree.call(this,e,t)},{init:function(e){frd.CommonSelectTree.prototype.init.call(this,e),this.getParent()._uSelectTree=this}}),TreeSearchText:ecui.inherits(frd.SearchText,"mousePoint",{onsearch:function(){var e=this.getParent();e.isSearching=!1,this.getValue()&&this.getValue().length>0&&(e.isSearching=!0),e._uSelectTree.queryTree(this.getValue()),e&&e.changeAllItemBtnState&&e.changeAllItemBtnState()},onclick:function(e){e.stopPropagation()}}),TreeCancelBtn:ecui.inherits(ecui.ui.Control,"mousePoint",{onclick:function(){this.getParent().hide()}}),TreeSuccessBtn:ecui.inherits(ecui.ui.Control,"mousePoint",{onclick:function(){var e=this.getParent();if(e.hide(),e.getParent().clickSuccess){var t=e._uSelectTree,i=t.getAllSelectTreeData(!1);e.getParent().clickSuccess(t._oData,i)}}}),changeTreeStatus:function(){}}),frd.MultipleChoiceText=ecui.inherits(ecui.ui.InputControl,function(e,t){ecui.ui.InputControl.call(this,e,t),this._sPlaceholder=t.placeholder?t.placeholder:"请选择",this._bNotNeedSearch=t.notNeedSearch,this._bNotNeedClear=t.notNeedClear,this._sNeedReloadChildren=t.needReloadChildren;var i=t.treeData;!function e(t,i){i=i?i+".":"",t.forEach(function(t,s){t.path=i+s,t.checked=t.checked?t.checked:0,t.isHide=!1,t.children&&t.children.length>0?e(t.children,t.path):t.isLeafNode=!0})}(i),this._oTreeData=i,this._bNotEdit=!!t.notEdit&&t.notEdit,this._oTreeData instanceof Array&&this._oTreeData.length>0?frd.util.addPathToTree(i,"",t.showName,t.idName):console.log("报错啦，MultipleChoiceText没有数据源");var s='<div class="rightItemcss rightItemcssBack rightItemcss-placeholder">'+this._sPlaceholder+"</div>",n=ecui.dom.create("DIV",{innerHTML:s});if(this._eShowLabel=ecui.dom.first(n),e.appendChild(this._eShowLabel),!this._bNotNeedClear){var a=ecui.dom.create("DIV",{innerHTML:'<div class="clearbtnCss">清空</div>'}),r=ecui.dom.first(a);e.appendChild(r),this._uClearBtn=ecui.$fastCreate(this.ClearAllBtn,r,this,{})}this.createPopView(e,t),this.selectedTrees=[],this.seletedValueIDs=[],this._sInSelectValue=t.inSelectValue},{createPopView:function(e,t){ecui.util.timer(function(){var i=!this._bNotNeedSearch,s=ecui.esr.getEngine().render("multipleChoiceTarget",{treeData:this._oTreeData,needSearch:i,inParam:t}),n=ecui.dom.create("DIV",{innerHTML:s}),a=ecui.dom.first(n),r=this.getMain().style.width;a.style.width=r,e.appendChild(a),ecui.init(a),a.getControl().hide(),this.setPopup(a.getControl()),this.treeOutControl=a.getControl()}.bind(this),50)},addSmallItem:function(e){if(e.length>0){this._eShowLabel.innerHTML="";for(var t=0;t<e.length;t++){var i=e[t],s=ecui.esr.getEngine().render("smallCityTarget",{selectItem:i}),n=ecui.dom.create("DIV",{innerHTML:s}),a=ecui.dom.first(n);this._eShowLabel.appendChild(a),ecui.init(a)}}else this._eShowLabel.innerHTML=this._sPlaceholder?this._sPlaceholder:"请选择",ecui.dom.addClass(this._eShowLabel,"rightItemcssBack")},onmouseout:function(){this._eShowLabel.style.width=this.showLabelWidth+"px",this.changeShowLabelHeight()},onmouseover:function(){this.selectedTrees.length>0?(this._eShowLabel.style.width=this.showLabelWidth-36+"px",ecui.dom.removeClass(this._eShowLabel,"rightItemcss-placeholder")):(ecui.dom.addClass(this._eShowLabel,"rightItemcss-placeholder"),this._eShowLabel.style.width=this.showLabelWidth+"px"),this.changeShowLabelHeight()},changeShowLabelHeight:function(){this._eShowLabel.scrollWidth-this._eShowLabel.offsetWidth>1?this._eShowLabel.style.height=Math.abs(this._eShowLabel.offsetHeight-this._eShowLabel.clientHeight)+this.showLabelHeight+"px":this._eShowLabel.style.height=this.showLabelHeight+"px"},findchildItemToPush:function(e,t){for(var i=0;i<e.length;i++){var s=e[i];if(!(s.id!=t||1===s.checked||s.children&&s.children.length>0)){this.selectedTrees.push(s);break}s.children&&s.children.length>0&&this.findchildItemToPush(s.children,t)}},changeDefaultValuewithInvalue:function(){this.selectedTrees=[];for(var e=this,t=function(i){if(i.children)for(var s=0;s<i.children.length;s++){var n=i.children[s];n.children&&n.children.length>0||1!=n.checked?t(n):e.selectedTrees.push(n)}},i=0;i<e._oTreeData.length;i++){var s=e._oTreeData[i];s.children&&s.children.length>0||1!=s.checked?t(s):e.selectedTrees.push(s)}this._sInSelectValue&&this._sInSelectValue instanceof Array&&this._sInSelectValue.length>0&&this._sInSelectValue.forEach(function(t){for(var i=0;i<e._oTreeData.length;i++){var s=e._oTreeData[i];if(!(s.id!=t||1===s.checked||s.children&&s.children.length>0)){e.selectedTrees.push(s);break}s.children&&s.children.length>0&&e.findchildItemToPush(s.children,t)}}),this.addSmallItem(this.selectedTrees),e.afterChangeArray(!0)},onready:function(){this.showLabelWidth=this._eShowLabel.clientWidth,this.showLabelHeight=this._eShowLabel.clientHeight,this.changeDefaultValuewithInvalue()},getChildrenValue:function(e){var t=this;e.forEach(function(e){e.children&&e.children.length>0?t.getChildrenValue(e.children):t.seletedValueIDs.push(e.id)})},getValue:function(){this.seletedValueIDs=[];var e=this;return this.selectedTrees.forEach(function(t){t.children&&t.children.length>0?e.getChildrenValue(t.children):e.seletedValueIDs.push(t.id)}),this.seletedValueIDs},onclick:function(){this._bNotEdit?(this.treeOutControl.alterStatus("+disable"),this.treeOutControl._uSelectTree.notEdit=this._bNotEdit):(this.treeOutControl.alterStatus("-disable"),this.treeOutControl._uSelectTree.notEdit=this._bNotEdit),this.treeOutControl._uSelectTree.resetSelectData(this.selectedTrees);var e=this.getMain().clientWidth;e<242&&(e=242),this.treeOutControl.getMain().style.width=e+"px"},clickSuccess:function(e,t){this.selectedTrees=t;this.addSmallItem(this.selectedTrees),this.afterChangeArray()},afterChangeArray:function(){if(0==this.selectedTrees.length?(this._eShowLabel.style.width=this.showLabelWidth+"px",this._eShowLabel.innerHTML=this._sPlaceholder?this._sPlaceholder:"请选择",this._uClearBtn&&(this._uClearBtn.getMain().style.width="0px"),0==ecui.dom.hasClass(this._eShowLabel,"rightItemcssBack")&&ecui.dom.addClass(this._eShowLabel,"rightItemcssBack"),ecui.dom.addClass(this._eShowLabel,"rightItemcss-placeholder")):(ecui.dom.removeClass(this._eShowLabel,"rightItemcssBack"),ecui.dom.removeClass(this._eShowLabel,"rightItemcss-placeholder"),this._uClearBtn&&(this._uClearBtn.getMain().style.width="36px")),this.changeShowLabelHeight(),1==this._sNeedReloadChildren){var e=ecui.esr.findRoute(this).children;e&&ecui.esr.callRoute(e,!0)}},DeleteBtn:ecui.inherits(ecui.ui.Control,function(e,t){ecui.ui.Control.call(this,e,t),this._sItemID=t.itemID},{onclick:function(e){var t=this.getParent(),i=this._sItemID,s=this.getParent().selectedTrees,n=-1;s.forEach(function(e,t){e.id==i&&(n=t)}),n>=0&&s.splice(n,1),ecui.dom.getParent(this.getMain()).remove(),t.afterChangeArray&&t.afterChangeArray(),e.stopPropagation()}}),ClearAllBtn:ecui.inherits(ecui.ui.Control,function(e,t){ecui.ui.Control.call(this,e,t),this._sItemID=t.itemID},{onclick:function(e){var t=this.getParent();t.selectedTrees.length>0&&(t._eShowLabel.innerHTML="",t.selectedTrees=[],t.afterChangeArray&&t.afterChangeArray(),e.stopPropagation())}}),initSuccess:function(){},setValue:function(e){""===e||e instanceof Array&&0==e.length?(this._eShowLabel.innerHTML="",this.selectedTrees=[],this.afterChangeArray&&this.afterChangeArray()):e instanceof Array&&e.length>0&&(this._sInSelectValue=e,this.changeDefaultValuewithInvalue())}},ecui.ui.Popup,{$dispose:function(){if(this.$PopupData.control){var e=this.$PopupData.control.getMain();e&&ecui.dom.remove(e),this.setPopup(),this.$Popup.$dispose.call(this)}}}),frd.LargeDataCommonSelectTree=ecui.inherits(frd.CommonSelectTree,{$nodeclick:function(e){if("node-selectview"===e.target.className)(t=frd.util.findControl(this.getMain(),frd.CommonSelectTree)).getRoot().notEdit||t.changeStatus();else if("frd-tree-item-title"===e.target.className){(t=frd.util.findControl(this.getMain(),frd.LargeDataCommonSelectTree))&&ecui.dispatchEvent(t,"arrowclick",e)}else if("arrow-icon"===e.target.className){var t;(t=frd.util.findControl(this.getMain(),frd.LargeDataCommonSelectTree))&&ecui.dispatchEvent(t,"arrowclick",e)}e.stopPropagation()}}),frd.LargeDataMultipleChoicePop=ecui.inherits(frd.MultipleChoicePop,{LargeDataSelectTree:ecui.inherits(frd.LargeDataCommonSelectTree,function(e,t){frd.LargeDataCommonSelectTree.call(this,e,t)},{init:function(e){frd.LargeDataCommonSelectTree.prototype.init.call(this,e),this.getParent()._uSelectTree=this}})}),frd.LargeMultipleChoiceText=ecui.inherits(frd.MultipleChoiceText,{createPopView:function(e,t){ecui.util.timer(function(){var i=!this._bNotNeedSearch,s=ecui.esr.getEngine().render("largeDataMultipleChoiceTarget",{treeData:this._oTreeData,needSearch:i,inParam:t}),n=ecui.dom.create("DIV",{innerHTML:s}),a=ecui.dom.first(n),r=this.getMain().style.width;a.style.width=r,e.appendChild(a),ecui.init(a),a.getControl().hide(),this.setPopup(a.getControl()),this.treeOutControl=a.getControl()}.bind(this),50)}}),frd.BaseButton=ecui.inherits(ecui.ui.Control,"frd-base-button",function(e,t){if(ecui.ui.Control.call(this,e,t),this._bLoading=t.loading,t.icon){var i=ecui.dom.create("IMG",{className:"button-img"});i.src=t.icon,ecui.dom.insertBefore(i,ecui.dom.first(this.getMain()))}t.btnType&&(ecui.dom.addClass(e,"frd-"+t.btnType+"-button"),"disable"===t.btnType&&this.disable()),t.size&&ecui.dom.addClass(e,"frd-"+t.size+"-button")},{$ready:function(){ecui.ui.Control.prototype.$ready.call(this),this._bLoading&&this.setLoading()},setLoading:function(){this.buttonContent=this.getContent(),this.setContent('<span class="first-circle">•</span><span class="secend-circle">•</span><span class="third-circle">•</span>')},removeLoading:function(){this.setContent(this.buttonContent)}}),frd.EventControl=ecui.inherits(frd.BaseButton,function(e,t){this._sRouteName=t.routeName,this._sMethodName=t.methodStr,this._oEventOptions=t,frd.BaseButton.call(this,e,t)},{getEventOptions:function(){return this._oEventOptions},onclick:function(e){var t;(e.preventDefault(),e.stopPropagation(),this._sMethodName)&&((t=this._sRouteName?ecui.esr.getRoute(this._sRouteName):ecui.esr.findRoute(this))&&t[this._sMethodName]&&t[this._sMethodName].call(t,this,this.getEventOptions()))}}),frd.CustomCalendar=ecui.inherits(ecui.ui.Calendar,function(e,t){ecui.ui.Calendar.call(this,e,t)},{$initView:function(){var e=ecui.ui.Calendar.prototype.$initView.call(this),t=this._eTitle.parentNode;return ecui.dom.children(t).forEach(function(e,t){0!==t&&(e.innerHTML="")}),e}}),frd.RangeDate=ecui.inherits(ecui.ui.Control,"ui-range-date",function(e,t){ecui.ui.Control.call(this,e,t),this._eFrom=ecui.dom.create("DIV",{className:"ui-calendar ui-calendar-left"}),this._eTo=ecui.dom.create("DIV",{className:"ui-calendar"}),e.appendChild(this._eFrom),e.appendChild(this._eTo),this._uFrom=ecui.$fastCreate(this.Calendar,this._eFrom,this),this._uTo=ecui.$fastCreate(this.Calendar,this._eTo,this)},{Calendar:ecui.inherits(frd.CustomCalendar,{}),onready:function(){ecui.dispatchEvent(this._uFrom,"ready"),ecui.dispatchEvent(this._uTo,"ready")}}),frd.MonthSelect=ecui.inherits(ecui.ui.Control,"frd-month-select",function(e,t){ecui.ui.Control.call(this,e,t),this._eHeader=ecui.dom.create("DIV",{className:this.getUnitClass(frd.MonthSelect,"header"),innerHTML:'<div class="pre"></div><div class="year"></div><div class="next"></div>'}),e.appendChild(this._eHeader);for(var i="",s=0;s<12;s++)i+='<div class="frd-month-cell"><div class="item-content">'+(s+1)+"月</div></div>";this._eMonths=ecui.dom.create("DIV",{className:this.getUnitClass(frd.MonthSelect,"content"),innerHTML:i}),e.appendChild(this._eMonths),this._aMonthes=[],ecui.dom.children(this._eMonths).forEach(function(e,t){this._aMonthes.push(ecui.$fastCreate(this.Cell,e,this,{month:t+1}))}.bind(this)),this._cYear=ecui.$fastCreate(this.Year,this._eHeader.children[1],this),this._cPre=ecui.$fastCreate(this.Option,this._eHeader.children[0],this,{optionType:1}),this._cNext=ecui.$fastCreate(this.Option,this._eHeader.children[2],this,{optionType:2})},{Cell:ecui.inherits(ecui.ui.Control,function(e,t){ecui.ui.Control.call(this,e,t),this._month=t.month},{$click:function(e){ecui.ui.Control.prototype.$click.call(this,e),e.item=this,e.month=this._month,ecui.dispatchEvent(this.getParent(),"dateclick",e)},getMonthStr:function(){return this._month<10?"0"+this._month:String(this._month)}}),Year:ecui.inherits(ecui.ui.Control,{}),Option:ecui.inherits(ecui.ui.Control,function(e,t){ecui.ui.Control.call(this,e,t),this._nType=t.optionType},{$click:function(){var e=this.getParent(),t=e._cYear;1===this._nType?e.setYear(Number(t.getContent())-1):e.setYear(Number(t.getContent())+1)}}),$dateclick:function(e){e.date=this.getYear()+"-"+(e.month<10?"0"+e.month:e.month),this.setSelected(e.item)},getSelectedMonth:function(){return this.selected&&this.selected.getBody().children[0].innerText},setMonth:function(e){this.setSelected(this._aMonthes[e])},setCurrentMonth:function(){var e=new Date,t=e.getFullYear(),i=e.getMonth();String(t)===this.getYear()?this._aMonthes[i].alterStatus("+now"):this._aMonthes[i].alterStatus("-now")},getYear:function(){return this._cYear.getContent()},setYear:function(e){e=String(e),/\d{4}/.test(e)&&(this._cYear.setContent(e),this.setCurrentMonth())},setDate:function(e){var t=e.split("-");this.setYear(t[0]),this.setMonth(t[1])},getDate:function(){return this.getYear()+"-"+this.getSelectedMonth()},isSelectedYear:function(){return-1!==this.selectedStr.indexOf(this.getYear())},setDisable:function(){},onready:function(){this.setDate(ecui.util.formatDate(new Date,"yyyy-MM-dd"))}},ecui.ui.Control.defineProperty("selected")),frd.RangeMonth=ecui.inherits(ecui.ui.Control,"frd-range-month",function(e,t){ecui.ui.Control.call(this,e,t),this._eFrom=ecui.dom.create("DIV",{className:"frd-month-select frd-month-select-left"}),this._eTo=ecui.dom.create("DIV",{className:"frd-month-select"}),e.appendChild(this._eFrom),e.appendChild(this._eTo),this._uFrom=ecui.$fastCreate(this.MonthSelect,this._eFrom,this),this._uTo=ecui.$fastCreate(this.MonthSelect,this._eTo,this),this._selectDates=[]},{MonthSelect:ecui.inherits(frd.MonthSelect,{Option:ecui.inherits(frd.MonthSelect.prototype.Option,{$click:function(e){this.getParent().isCanClick(this._nType)&&(frd.MonthSelect.prototype.Option.prototype.$click.call(this,e),ecui.dispatchEvent(this.getParent().getParent(),"yearchagne"))}}),Cell:ecui.inherits(frd.MonthSelect.prototype.Cell,{$click:function(e){ecui.ui.Control.prototype.$click.call(this,e),e.item=this,e.month=this._month,!this._bIsDisabled&&ecui.dispatchEvent(this.getParent(),"dateclick",e)},$mousemove:function(e){ecui.ui.Control.prototype.$mousemove.call(this,e),e.item=this,e.month=this._month,!this._bIsDisabled&&ecui.dispatchEvent(this.getParent(),"datehover",e)},getMonthStr:function(){return this._month<10?"0"+this._month:String(this._month)}}),isCanClick:function(e){return this.getParent().isCanClick(e,this)},$dateclick:function(e){e.date=this.getYear()+"-"+(e.month<10?"0"+e.month:e.month),ecui.dispatchEvent(this.getParent(),"dateclick",e)},$datehover:function(e){e.date=this.getYear()+"-"+(e.month<10?"0"+e.month:e.month),ecui.dispatchEvent(this.getParent(),"datehover",e)},refreshSelectStatus:function(e){var t=e[0],i=t.split("-")[0],s=t.split("-")[1],n=this.getYear();this._aMonthes.forEach(function(e){e.alterStatus("-selected")}),i===n&&this._aMonthes.forEach(function(e){e.getMonthStr()===s&&e.alterStatus("+selected")})},refreshDisableStatus:function(){var e=this.getYear();this._aMonthes.forEach(function(t){t._bIsDisabled=!1,ecui.dom.removeClass(t.getMain(),"frd-month-cell-forbid"),this.getParent().getParent().disabledDate(e,t.getMonthStr())||(t._bIsDisabled=!0,ecui.dom.addClass(t.getMain(),"frd-month-cell-forbid"))}.bind(this))},refreshMonthViewStatus:function(e){if(1!==e.length){if(this.clearStyle(),0!==e.length){var t=e[0],i=e[1],s=t.split("-")[0],n=t.split("-")[1],a=i.split("-")[0],r=i.split("-")[1],o=this.getYear();s<=o&&a>=o&&(s<o&&(a>o&&this._aMonthes.forEach(function(e){e.alterStatus("+inrange")}),a===o&&this._aMonthes.forEach(function(e){e.getMonthStr()===r&&e.alterStatus("+endrange")&&e.alterStatus("+selected"),e.getMonthStr()<r&&e.alterStatus("+inrange")})),s===o&&(a>o&&this._aMonthes.forEach(function(e){e.getMonthStr()===n&&e.alterStatus("+startrange")&&e.alterStatus("+selected"),e.getMonthStr()>n&&e.alterStatus("+inrange")}),a===o&&this._aMonthes.forEach(function(e){e.getMonthStr()===r&&e.alterStatus("+endrange")&&e.alterStatus("+selected"),e.getMonthStr()===n&&e.alterStatus("+startrange")&&e.alterStatus("+selected"),e.getMonthStr()>n&&e._month<r&&e.alterStatus("+inrange")})))}}else this.refreshSelectStatus(e)},clearStyle:function(){this._aMonthes.forEach(function(e){e.alterStatus("-inrange"),e.alterStatus("-startrange"),e.alterStatus("-endrange"),e.alterStatus("-selected")})},onready:function(){}}),$dateclick:function(e){var t=e.date;2===this._selectDates.length&&(this._selectDates=[]),this._selectDates.push(t),2===this._selectDates.length&&(this._selectDates.sort(),ecui.dispatchEvent(this,"change")),this._uFrom.refreshMonthViewStatus(this._selectDates),this._uTo.refreshMonthViewStatus(this._selectDates)},resetDateNode:function(){this._uFrom.clearStyle(),this._uTo.clearStyle()},onyearchagne:function(){this._uFrom.refreshMonthViewStatus(this._selectDates),this._uTo.refreshMonthViewStatus(this._selectDates),this._uFrom.refreshDisableStatus(),this._uTo.refreshDisableStatus()},$datehover:function(e){var t=e.date,i=JSON.parse(JSON.stringify(this._selectDates));1===i.length&&(i.push(t),i.sort(),this._uFrom.refreshMonthViewStatus(i),this._uTo.refreshMonthViewStatus(i))},setSelectDates:function(e){this._selectDates=e,this._uFrom.setDate(e[0]),e[0].split("-")[0]===e[1].split("-")[0]?this._uTo.setDate(Number(e[1].split("-")[0])+1+"-"+e[1].split("-")[1]):this._uTo.setDate(e[1]),this._uFrom.refreshMonthViewStatus(e),this._uTo.refreshMonthViewStatus(e),this._uFrom.refreshDisableStatus(),this._uTo.refreshDisableStatus()},resetYear:function(){var e=(new Date).getFullYear();this._uFrom.setYear(e),this._uTo.setYear(e+1),this._uFrom.refreshDisableStatus(),this._uTo.refreshDisableStatus()},isCanClick:function(e,t){var i=this._uFrom.getYear(),s=this._uTo.getYear();return 1===e?t===this._uFrom?i--:s--:t===this._uFrom?i++:s++,i-s<0}}),frd.RangeMonthSelectDate=ecui.inherits(ecui.ui.Control,"frd-range-month-input",function(e,t){ecui.ui.Control.call(this,e,t),t.start&&(this._startDate=t.start),t.end&&(this._endDate=t.end),this._uRangeMonthView=ecui.$fastCreate(this.RangeMonthView,ecui.dom.create("DIV",{style:"position:absolute;"}),this,{primary:"frd-range-month"}),this._uRangeMonthView.hide(),this.setPopup(this._uRangeMonthView),ecui.dom.insertHTML(e,"beforeEnd",'<input class="ui-hide" name="'+t.startName+'"><input class="ui-hide" name="'+t.endName+'">');var i=e.getElementsByTagName("INPUT");this._uBeginInput=ecui.$fastCreate(this.Input,i[0],this,{name:t.startName}),this._uEndInput=ecui.$fastCreate(this.Input,i[1],this,{name:t.endName});var s=t.placeholder||"请选择日期",n=ecui.dom.create("DIV",{className:this.getUnitClass(frd.RangeMonthSelectDate,"text"),innerHTML:s});ecui.dom.insertBefore(n,ecui.dom.first(e)),this._uText=ecui.$fastCreate(this.Text,ecui.dom.first(e),this,{capturable:!1,placeholder:s}),t.startValue&&t.endValue?(this._uBeginInput.setValue(t.startValue),this._uEndInput.setValue(t.endValue)):(this._uBeginInput.setValue(""),this._uEndInput.setValue("")),this._uText._value?this.alterStatus("-placeholder"):this.alterStatus("+placeholder"),e.appendChild(ecui.dom.create("SPAN",{className:"arrow-down-icon"}))},{disabledDate:function(e,t){var i=e+"-"+t;if(this._startDate||this._endDate){if(this._startDate&&this._endDate)return i>=this._startDate&&this._endDate>=i;if(this._startDate)return i>=this._startDate;if(this._endDate)return this._endDate>=i}return!0},Clear:ecui.inherits(ecui.ui.Control,{onclick:function(e){this.getParent().setValue(""),e.preventDefault(),e.stopPropagation()}}),Input:ecui.inherits(ecui.ui.InputControl,{setValue:function(e){ecui.ui.InputControl.prototype.setValue.call(this,e),this.getParent().refreshText()},setSelectValue:function(e){ecui.ui.InputControl.prototype.setValue.call(this,e)}}),Text:ecui.inherits(ecui.ui.Control,function(e,t){ecui.ui.Control.call(this,e,t),this._sPlaceholder=t.placeholder},{setValue:function(e){this._value=e,this.setContent(e||this._sPlaceholder)}}),RangeMonthView:ecui.inherits(frd.RangeMonth,{onchange:function(){this.getParent().selectMonthChange(this._selectDates),this.hide()}}),selectMonthChange:function(e){this._uBeginInput.setSelectValue(e[0]),this._uEndInput.setSelectValue(e[1]),this.setShowText(e)},refreshText:function(){var e=this._uBeginInput.getValue(),t=this._uEndInput.getValue();e&&t?(this.setShowText([e,t]),this._uRangeMonthView.setSelectDates([e,t])):(this.setShowText(),this._uRangeMonthView._selectDates=[],this._uRangeMonthView.resetDateNode(),this._uRangeMonthView.resetYear())},setValue:function(e){e&&2===e.length?(e=e.map(function(e){return"string"==typeof e?new Date(e).pattern("yyyy-MM"):e.pattern("yyyy-MM")}),this._uBeginInput.setSelectValue(e[0]),this._uEndInput.setSelectValue(e[1]),this.refreshText()):(this._uBeginInput.setSelectValue(""),this._uEndInput.setSelectValue(""),this.refreshText())},setShowText:function(e){e?this._uText.setValue(e.join(" - ")):this._uText.setValue()}},ecui.ui.Popup),frd.Card=ecui.inherits(ecui.ui.Control,"ui-card",function(e,t){if(ecui.ui.Control.call(this,e,t),2!==ecui.dom.children(e).length){for(this._eCardMain=ecui.dom.create("DIV"),this._eCardMain.className="card-main";e.firstChild;)this._eCardMain.appendChild(e.firstChild);e.appendChild(this._eCardMain)}else{this._eCardMain=ecui.dom.first(e),this._eCardSub=ecui.dom.last(e),this._eCardMain.className="card-main",this._eCardSub.className="card-sub";var i=ecui.dom.create("DIV",{innerHTML:"展开"});this._eCardMain.appendChild(i)}this._uCardMain=ecui.$fastCreate(this.CardMain,this._eCardMain,this),this._eCardSub&&(this._uCardSub=ecui.$fastCreate(this.CardSub,this._eCardSub,this),ecui.create(this.Button,{main:i,parent:this._uCardMain,size:"small",btnType:"text"})),this._bDrag=t.isDrag,this._bDrag&&(e.style.position="absolute")},{CardMain:ecui.inherits(ecui.ui.Control,function(e,t){ecui.ui.Control.call(this,e,t)},{}),CardSub:ecui.inherits(ecui.ui.Control,{}),Button:ecui.inherits(frd.BaseButton,{$click:function(e){frd.BaseButton.prototype.$click.call(this,e);var t=this.getParent().getParent();t._uCardSub&&(t._uCardSub.isShow()?(t._uCardSub.hide(),this.setContent("展开")):(t._uCardSub.show(),this.setContent("收起")))}}),$ready:function(){ecui.ui.Control.prototype.$ready.call(this),this._uCardSub&&this._uCardSub.hide(),this._bDrag&&(this.origenPos={left:this.getX(),top:this.getY()})},$activate:function(e){ecui.ui.Control.prototype.$activate.call(this,e),this._bDrag&&ecui.drag(this,e)},$dragend:function(e){ecui.ui.Control.prototype.$dragend.call(this,e),this.alterStatus("-draging"),ecui.getHovered()&&(ecui.getHovered().onconfirm||ecui.getHovered().$confirm?ecui.dispatchEvent(ecui.getHovered(),"confirm",{}):this.reset())},$dragstart:function(e){ecui.ui.Control.prototype.$dragstart.call(this,e),this.alterStatus("+draging")},reset:function(){this.setPosition(this.origenPos.left,this.origenPos.top)}}),frd.Crumb=ecui.inherits(ecui.ui.Control,"ui-crumb",function(e,t){ecui.ui.Control.call(this,e,t)},{Item:ecui.inherits(ecui.ui.Item,function(e,t){ecui.ui.Item.call(this,e,t),ecui.dom.last(e).style.display="none"}),$alterItems:ecui.util.blank},ecui.ui.Items,{add:function(e,t){var i=this.getItems();i.length&&(ecui.dom.last(i[i.length-1].getMain()).style.display=""),ecui.ui.Items.Methods.add.call(this,e,t)}}),frd.CrumbAddButton=ecui.inherits(ecui.ui.Control,function(e,t){ecui.ui.Control.call(this,e,t),this._sType=t.textType},{count:0,onclick:function(){var e=ecui.query(function(e){return e instanceof frd.Crumb&&ecui.dom.contain(ecui.dom.parent(this.getMain()),e.getMain())}.bind(this))[0];this.count>4&&(this.count=0,e.removeAll()),this.count++,"overflow"===this._sType&&2===this.count?e.add(ecui.esr.getEngine().render("crumbItem",{content:this.count+"级菜单一个超长的菜单，特别特别的长肯定放不下"})):e.add(ecui.esr.getEngine().render("crumbItem",{content:this.count+"级菜单"}))}}),frd.MFont=ecui.inherits(ecui.ui.Control,"ui-m-font",function(e,t){ecui.ui.Control.call(this,e,t),this._sType=t.fontType},{$ready:function(){this.alterStatus("+"+this._sType)}}),frd.Font=ecui.inherits(ecui.ui.Control,"ui-font",function(e,t){ecui.ui.Control.call(this,e,t),this._sType=t.fontType},{$ready:function(){this.alterStatus("+"+this._sType)}}),frd.HorizontalLockTable=ecui.inherits(ecui.ui.Control,"ui-lock-table",function(e,t){ecui.ui.Control.call(this,e,t),this._nRight=Number(t.right)||0,this._nLeft=Number(t.left)||0},{$initStructure:function(){this._nLeft&&(this._eLeft=ecui.dom.create("div",{innerHTML:"<table></table>",className:"left-table"})),this._eMiddle=ecui.dom.create("div",{className:"middle-table"}),this._eMiddleWrap=ecui.dom.create("div",{className:"middle-table-wrap"}),this._nRight&&(this._eRight=ecui.dom.create("div",{innerHTML:"<table></table>",className:"left-table"})),this._eMiddleWrap.appendChild(this._eMiddle),this._eMiddle.appendChild(ecui.dom.first(this.getMain()));var e=ecui.dom.first(this._eMiddle).rows,t=ecui.dom.first(this._eLeft),i=0;ecui.dom.toArray(e).forEach(function(e,s){for(var n=ecui.dom.create("tr"),a=0;a<this._nLeft;a++){var r=ecui.dom.children(e)[a];n.appendChild(r),0===s&&(i+=Number(r.style.width.replace("px","")))}t.appendChild(n)}.bind(this)),this.getMain().appendChild(this._eLeft),this.getMain().appendChild(this._eMiddleWrap),this._eLeft.style.width=i+"px";var s=this.getMain().clientWidth;this._eMiddleWrap.style.width=s-i+"px",this._eMiddleWrap.style.overflow="auto"}}),frd.RowLockTable=ecui.inherits(ecui.ui.Control,"frd-row-lock-table",function(e,t){ecui.ui.Control.call(this,e,t),this._nRight=Number(t.right)||0,this._nLeft=Number(t.left)||0,this._init()},{_init:function(){var e=ecui.dom.first(this.getMain()),t=e.querySelector("thead");e.querySelector("tbody");this._eMiddleSection=ecui.dom.create("div",{className:"middle-table-section",innerHTML:'<div class="table-header"><table></table></div><div class="table-body"></div>'});var i=this._eMiddleSection.querySelector(".table-header table"),s=this._eMiddleSection.querySelector(".table-body");i.appendChild(t),s.appendChild(e);var n=e;if(this._nLeft){this._eLeftSection=ecui.dom.create("div",{innerHTML:'<div class="table-header"><table><thead></thead></table></div><div class="table-body"><table><tbody></tbody></table></div>',className:"left-table-section"});var a=this._eLeftSection.querySelector(".table-header table thead"),r=this._eLeftSection.querySelector(".table-body table tbody"),o=0;ecui.dom.toArray(i.rows).forEach(function(e,t){for(var i=ecui.dom.create("tr"),s=0;s<this._nLeft;s++){var n=ecui.dom.children(e)[s].cloneNode(!0);i.appendChild(n),0===t&&(o+=Number(n.style.width.replace("px","")))}a.appendChild(i)}.bind(this)),ecui.dom.toArray(n.rows).forEach(function(e,t){for(var i=ecui.dom.create("tr"),s=0;s<this._nLeft;s++){var n=ecui.dom.children(e)[s].cloneNode(!0);i.appendChild(n)}r.appendChild(i)}.bind(this)),this.getMain().appendChild(this._eLeftSection)}this.getMain().appendChild(this._eMiddleSection),this._eLeftSection.style.width=o+"px"}}),frd.SimulationLockTable=ecui.inherits(ecui.ui.Control,"frd-simnulation-lock-table",function(e,t){ecui.ui.Control.call(this,e,t),this._eHeadSection=ecui.dom.first(e),this._eBodySection=ecui.dom.last(e),this._lastX=0,this._lockColumnNum=t.left||0,this._initCssText(),this._initLockColumn(),this._eBodySection.addEventListener("scroll",this._scroll.bind(this))},{_initLockColumn:function(){var e=ecui.dom.children(this._eHeadSection),t=ecui.dom.children(this._eBodySection),i=[],s=this._lockColumnNum;e.slice(0,s).forEach(function(e,t){i[t]=e.offsetWidth,ecui.dom.addClass(e,"frd-table-item-sticky"),t===s-1&&ecui.dom.addClass(e,"frd-table-item-side"),e.style.left=i.slice(0,t).reduce(function(e,t){return e+t},0)+"px"}),t.forEach(function(e){ecui.dom.children(e).slice(0,s).forEach(function(e,t){ecui.dom.addClass(e,"frd-table-item-sticky"),t===s-1&&ecui.dom.addClass(e,"frd-table-item-side"),e.style.left=i.slice(0,t).reduce(function(e,t){return e+t},0)+"px"})})},_initCssText:function(){var e="grid-template-columns:";ecui.dom.children(this._eHeadSection).forEach(function(t){e+=(t.style.width||"1fr")+" "}),e+=";",this._eHeadSection.style.cssText+=e,this._eBodySection.style.cssText+=e},$scroll:function(e){ecui.ui.Control.prototype.$scroll.call(this,e),0!==e.deltaX&&this._scroll()},_scroll:function(){this.syncXPostion()},syncXPostion:function(){var e=this._eHeadSection.scrollLeft,t=this._eBodySection.scrollLeft;e!==this._lastX?this._eBodySection.scrollLeft=e:this._eHeadSection.scrollLeft=t,this._lastX=this._eHeadSection.scrollLeft},onready:function(){this._eHeadSection.style.marginRight=Math.abs(this._eBodySection.offsetWidth-this._eBodySection.clientWidth)+"px"}}),frd.HorizontalNavigator=ecui.inherits(ecui.ui.Control,"ui-horizontal-navigator",function(e,t){ecui.ui.Control.call(this,e,t)},{Item:ecui.inherits(ecui.ui.Item,function(e,t){if(ecui.ui.Item.call(this,e,t),ecui.dom.children(e).length>1){ecui.dom.addClass(e,"ui-sub-items");for(var i=ecui.dom.create("DIV",{className:"ui-popup ui-horizontal-navigator-popup ui-hide"});ecui.dom.children(e).length>1;)i.appendChild(ecui.dom.children(e)[1]);document.body.appendChild(i),this._uPopItems=ecui.$fastCreate(this.PopItems,i,this)}},{PopItems:ecui.inherits(ecui.ui.Control,{$alterItems:ecui.util.blank,$itemclick:function(e){this.selected&&this.selected.alterStatus("-selected"),this.selected=e.item,this.selected.alterStatus("+selected")}},ecui.ui.Items),$initStructure:function(e){if(ecui.ui.Item.prototype.$initStructure.call(this,e),this._uPopItems){var t=this.getMain(),i=this._uPopItems.getMain(),s=ecui.dom.getPosition(t);i.style.left=s.left+"px",i.style.top=s.top+t.offsetHeight+"px"}},$mouseover:function(e){ecui.ui.Item.prototype.$mouseover.call(this,e),this._uPopItems&&this._uPopItems.show()},$mouseout:function(e){ecui.ui.Item.prototype.$mouseout.call(this,e),this._uPopItems&&this._uPopItems.hide()}}),$alterItems:ecui.util.blank,$itemclick:function(e){this.selected&&this.selected.alterStatus("-selected"),this.selected=e.item,this.selected.alterStatus("+selected")}},ecui.ui.Items),frd.VerticalNavigator=ecui.inherits(ecui.ui.TreeView,function(e,t){ecui.ui.TreeView.call(this,e,t)},{$nodeclick:function(){this._eContainer?this.isCollapsed()?(this.expand(),ecui.dispatchEvent(this,"expand")):(this.collapse(),ecui.dispatchEvent(this,"collapse")):this.getRoot().setSelected(this)},setSelected:function(e){var t=this.$SelectedData.value;if(ecui.ui.TreeView.prototype.setSelected.call(this,e),t&&e!==t)for(t=t.getParent();t&&t.getRoot&&t!==t.getRoot();)t.alterStatus("-pselected"),t=t.getParent();for(e=e&&e.getParent();e&&e.getRoot&&e!==e.getRoot();)e.alterStatus("+pselected"),e=e.getParent()},setSelectItem:function(e){for(var t,i=[this];0!==i.length&&(this===(t=i.shift())||!e(t));)t._aChildren&&i.push.apply(i,t._aChildren),t=null;if(null!==t){var s=t.getParent();s&&s.isCollapsed&&s.isCollapsed()&&ecui.dispatchEvent(s,"arrowclick"),this.getRoot().setSelected(t)}}}),frd.VerticalPopNavigator=ecui.inherits(ecui.ui.PopupMenu,function(e,t){ecui.ui.PopupMenu.call(this,e,t)},{Item:ecui.inherits(ecui.ui.PopupMenu.prototype.Item,function(e,t){ecui.ui.PopupMenu.prototype.Item.call(this,e,t),this._bScale=!!t.scale},{onclick:function(t){this._bScale&&(this.isScaled?(this.getParent().alterStatus("-scale"),this.isScaled=!1,this.setContent("<<")):(this.getParent().alterStatus("+scale"),this.isScaled=!0,this.setContent(">>")),this.getParent().cache(!0)),t.item&&(e&&e.alterStatus("-selected"),(e=t.item).alterStatus("+selected"))}}),onitemclick:function(e){this.selected&&this.selected.alterStatus("-selected"),this.selected=e.item,this.selected.alterStatus("+selected")}}),frd.CustomRadio=ecui.inherits(ecui.ui.Radio,function(e,t){ecui.ui.Radio.call(this,e,t),ecui.dom.addClass(e,"ui-radio-"+t.size||"middle")},{}),frd.CustomCheckbox=ecui.inherits(ecui.ui.Checkbox,function(e,t){ecui.ui.Checkbox.call(this,e,t),ecui.dom.addClass(e,"ui-checkbox-"+t.size||"middle")},{}),frd.StartAndOff=ecui.inherits(ecui.ui.Checkbox,"ui-start-and-off",function(e,t){ecui.ui.Checkbox.call(this,e,t),this._eBall=ecui.dom.create("DIV",{className:"start-and-off-ball"}),e.appendChild(this._eBall)},{}),frd.SimulationRadio=ecui.inherits(ecui.ui.InputControl,"frd-simulation-radio",[function(e,t){t.value&&this.setValue(t.value)},function(e,t){for(var i=ecui.dom.create("DIV",{className:this.getUnitClass(frd.SimulationRadio,"options")});e.firstChild;)i.appendChild(e.firstChild);ecui.ui.InputControl.call(this,e,t),ecui.dom.addClass(this._eInput,"ui-hide"),e.appendChild(i),this.$setBody(i)}],{$alterItems:ecui.util.blank,Item:ecui.inherits(ecui.ui.Item,function(e,t){t.focusable=!1,ecui.ui.Item.call(this,e,t),this._sValue=void 0===t.value?ecui.dom.getText(e):String(t.value)},{$click:function(e){ecui.ui.Item.prototype.$click.call(this,e);var t=this.getParent();t.getSelected()!==this&&(t.setSelected(this),ecui.dispatchEvent(t,"change",e))},getValue:function(){return this._sValue}}),onchange:function(e){e&&e.item&&this.$setValue(e.item._sValue)},setValue:function(e){this.getItems().every(function(t){return t._sValue!==e||(this.setSelected(t),!1)},this)&&this.setSelected()},$propertychange:function(e){"selected"===e.name&&(e.item?this.$setValue(e.item._sValue):this.$setValue(""))}},ecui.ui.Items,ecui.ui.Control.defineProperty("selected")),frd.SingleOrNoneSimulationRadio=ecui.inherits(ecui.ui.InputControl,"frd-simulation-radio",[function(e,t){t.value&&this.setValue(t.value)},function(e,t){for(var i=ecui.dom.create("DIV",{className:this.getUnitClass(frd.SingleOrNoneSimulationRadio,"options")});e.firstChild;)i.appendChild(e.firstChild);ecui.ui.InputControl.call(this,e,t),ecui.dom.addClass(this._eInput,"ui-hide"),e.appendChild(i),this.$setBody(i)}],{$alterItems:ecui.util.blank,Item:ecui.inherits(ecui.ui.Item,function(e,t){t.focusable=!1,ecui.ui.Item.call(this,e,t),this._sValue=void 0===t.value?ecui.dom.getText(e):String(t.value),this._bSelectedState=!1},{$click:function(e){ecui.ui.Item.prototype.$click.call(this,e);var t=this.getParent();this._bSelectedState=!this._bSelectedState,ecui.dispatchEvent(t,"change",e)},getValue:function(){return this._sValue}}),onchange:function(e){e&&e.item&&(!1===e.item._bSelectedState?this.setValue(""):this.setValue(e.item._sValue))},setValue:function(e){var t=!1,i=this;this.getItems().forEach(function(s){s._sValue===e?(s._bSelectedState=!0,i.setSelected(s),t=!0):s._bSelectedState=!1}),!1===t&&this.setSelected()},$propertychange:function(e){"selected"===e.name&&(e.item?this.$setValue(e.item._sValue):this.$setValue(""))}},ecui.ui.Items,ecui.ui.Control.defineProperty("selected")),frd.MultiSimulationRadio=ecui.inherits(ecui.ui.InputControl,"frd-simulation-radio",[function(e,t){t.value&&this.setValue(t.value)},function(e,t){for(var i=ecui.dom.create("DIV",{className:this.getUnitClass(frd.MultiSimulationRadio,"options")});e.firstChild;)i.appendChild(e.firstChild);ecui.ui.InputControl.call(this,e,t),ecui.dom.addClass(this._eInput,"ui-hide"),e.appendChild(i),this.$setBody(i)}],{$alterItems:ecui.util.blank,Item:ecui.inherits(ecui.ui.Item,function(e,t){t.focusable=!1,ecui.ui.Item.call(this,e,t),this._sValue=void 0===t.value?ecui.dom.getText(e):String(t.value),this._bSelectedState=!1},{$click:function(e){ecui.ui.Item.prototype.$click.call(this,e),this._bSelectedState=!this._bSelectedState,this.changeDomStyle()},changeDomStyle:function(){this._bSelectedState?this.alterStatus("+selected"):this.alterStatus("-selected")},getValue:function(){return this._sValue}}),setValue:function(e){e instanceof Array&&this.getItems().forEach(function(t){void 0!==e.indexOf(t._sValue)&&e.indexOf(t._sValue)>-1?t._bSelectedState=!0:t._bSelectedState=!1,t.changeDomStyle()})},getValue:function(){var e=[];return this.getItems().forEach(function(t){t._bSelectedState&&e.push(t._sValue)}),e}},ecui.ui.Items),frd.CustomSelect=ecui.inherits(ecui.ui.Select,"ui-custom-select",function(e,t){switch(this._sSize=t.size||"middle",this._sSize){case"small":Object.assign(t,{optionSize:7});break;case"middle":Object.assign(t,{optionSize:6});break;case"big":Object.assign(t,{optionSize:5})}ecui.ui.Select.call(this,e,t),this._nOptionWidth=Number(t.optionWidth)},{Options:ecui.inherits(ecui.ui.Select.prototype.Options,{Item:ecui.inherits(ecui.ui.Select.prototype.Options.prototype.Item,{}),$alterItems:function(){ecui.ui.Select.prototype.Options.prototype.$alterItems.call(this);var e=this.getParent(),t=0,i=e._nOptionWidth||e.getWidth(),s=this.getMinimumHeight();e.getItems().forEach(function(e){e.isShow()&&t++}),t&&(s=Math.min(t,e._nOptionSize)*e.getItems()[0].getHeight()),this.$setSize(i,s)}}),$ready:function(){ecui.ui.Select.prototype.$ready.call(this),this.alterStatus("+"+this._sSize),this._uOptions.alterStatus("+"+this._sSize)},setValue:function(e){this.getItems().every(function(t){return t._sValue!==e||!t.isCapturable()||(this.setSelected(t),!1)},this)&&this.setSelected()}}),frd.MutiLevelSelect=ecui.inherits(ecui.ui.InputControl,"frd-muti-level-select",function(e,t){this._eOptions=ecui.dom.create("div",{className:"ui-popup frd-muti-level-select-options ui-hide",innerHTML:'<div class="frd-input"></div>'}),this._eOptions.appendChild(ecui.dom.first(e)),ecui.ui.InputControl.call(this,e,t),this._eText=ecui.dom.create("div",{className:"frd-muti-level-select-text"}),e.appendChild(this._eText),this._uOptions=ecui.$fastCreate(this.Options,this._eOptions,this,{}),this.setPopup(this._uOptions),this.defaultValue=t.value||"",this.defaultText=t.text||"",this.placeholder=t.placeholder||""},{Options:ecui.inherits(ecui.ui.Control,function(e,t){ecui.ui.Control.call(this,e,t),this._ePopMenu=ecui.dom.last(e),ecui.dom.addClass(this._ePopMenu,"frd-pop-menu"),this._uSearch=ecui.$fastCreate(this.Search,ecui.dom.first(e),this,{placeholder:"请搜索"}),this._uPopMenu=ecui.$fastCreate(this.PopMenu,this._ePopMenu,this,{})},{Search:ecui.inherits(ecui.ui.Text,{oninput:function(e){var t=this.getValue();this.getParent()._uPopMenu.getItems().forEach(function(e){-1!==e.getContent().indexOf(t)?e.show():e.hide()})}}),PopMenu:ecui.inherits(ecui.ui.PopupMenu,{Item:ecui.inherits(ecui.ui.PopupMenu.prototype.Item,function(e,t){if("UL"===e.tagName){var i=e;e=ecui.dom.insertBefore(ecui.dom.first(e),i),document.body.appendChild(i),ecui.dom.addClass(i,"ui-popup-menu ui-hide ui-popup-customer")}ecui.ui.Item.call(this,e,t),this.value=t.value||this.getContent(),i&&this.setChildMenu(ecui.$fastCreate(frd.MutiLevelSelect.prototype.Options.prototype.PopMenu,i,this))},{$click:function(e){ecui.dom.contain(this.getMain(),e.target)&&ecui.ui.PopupMenu.prototype.Item.prototype.$click.call(this,e)}}),onitemclick:function(e){if(!e.item._cChildMenu){for(var t=this;!(t instanceof frd.MutiLevelSelect.prototype.Options);t=t.getParent());t.getParent().setText(e.item.getContent()),t.getParent().setValue(e.item.value),t.hide()}}})}),setText:function(e){this._eText.innerHTML=e},setPlaceholder:function(){this.getValue()?this.alterStatus("-placeholder"):(this.alterStatus("+placeholder"),this.setText(this.placeholder))},setValue:function(e){ecui.ui.InputControl.prototype.setValue.call(this,e),this.setPlaceholder()},onready:function(){this.setText(this.defaultText),this.setValue(this.defaultValue)}},ecui.ui.Popup),frd.Pagination=ecui.inherits(ecui.ui.Control,"ui-pagination",function(e,t){ecui.ui.Control.call(this,e,t),this._nTotal=Number(t.total)||0,this._nPageSize=Number(t.pageSize)||10,this._nPageNo=Number(t.pageNo)||1,this._nTotalPage=Math.ceil(this._nTotal/this._nPageSize),this._eInfo=ecui.dom.create("DIV",{className:"page-info"}),e.appendChild(this._eInfo),this._uPageInfo=ecui.$fastCreate(this.PageInfo,this._eInfo,this),this._ePages=ecui.dom.create("UL",{className:"page-num-wrap"});for(var i=1;i<this._nTotalPage+1;i++)this._nTotalPage,i>7&&i!==this._nTotalPage||this._ePages.appendChild(ecui.dom.create("LI",{innerHTML:i}));this._nTotalPage>8&&(ecui.dom.insertAfter(ecui.dom.create("LI",{innerHTML:"...",className:"ellipsis ui-hide"}),ecui.dom.first(this._ePages)),ecui.dom.insertBefore(ecui.dom.create("LI",{innerHTML:"...",className:"ellipsis"}),ecui.dom.last(this._ePages))),e.appendChild(this._ePages),this._uPages=ecui.$fastCreate(this.Pages,this._ePages,this),!1===this.hascreatePageSize()&&(this._ePageSize=ecui.dom.create("DIV",{className:"page-size",innerHTML:'<div ui="value:20">20条/页</div><div ui="value:50">50条/页</div><div ui="value:100">100条/页</div>'})),e.appendChild(this._ePageSize),ecui.$fastCreate(this.PageSize,this._ePageSize,this),this._ePageJump=ecui.dom.create("DIV",{className:"page-jump",innerHTML:'跳至<div class="ui-text"></div><span>页</span>'}),e.appendChild(this._ePageJump),ecui.$fastCreate(this.JumpTo,ecui.dom.first(this._ePageJump),this,{min:1,decimal:0}),this.route=t.route},{hascreatePageSize:function(){return!1},getRoute:function(){return this.route||(this.route=ecui.esr.findRoute(this).NAME),this.route},PageInfo:ecui.inherits(ecui.ui.Control,{onready:function(){this.setContent("1-10 / "+this.getParent()._nTotal)}}),Pages:ecui.inherits(ecui.ui.Control,function(e,t){this._ePre=ecui.dom.insertBefore(ecui.dom.create("LI",{className:"pre-item"}),ecui.dom.first(e)),this._eNext=ecui.dom.insertAfter(ecui.dom.create("LI",{className:"next-item"}),ecui.dom.last(e)),ecui.ui.Control.call(this,e,t)},{$alterItems:ecui.util.blank,onitemclick:function(e){if(0===e.index)this.currentPage>1&&(i=this.currentPage-1);else if(e.index===this.getItems().length-1)this.currentPage<this.getParent()._nTotalPage&&(i=this.currentPage+1);else var t=e.item,i=Number(t.getContent());i&&this.setPage(i)},setPage:function(e){this.getParent()._nTotalPage<e&&(e=this.getParent()._nTotalPage),this.setSelected(e),this.getParent().getRoute()&&ecui.esr.callRoute(this.getParent().getRoute()+"~pageNum="+e+"~pageNo="+e,!0)},setSelected:function(e){if(this.currentPage=e,this.getParent()._nTotalPage>8)if(this.getItems()[2].show(),this.getItems()[2].alterStatus("-both"),this.getItems()[this.getItems().length-3].alterStatus("-both"),e>4&&e<this.getParent()._nTotalPage-4){for(var t=3;t<=8;t++)this.getItems()[t].setContent(e-5+t);this.getItems()[this.getItems().length-3].show(),this.getItems()[2].alterStatus("+both"),this.getItems()[this.getItems().length-3].alterStatus("+both")}else if(e>=this.getParent()._nTotalPage-4){for(t=3;t<=8;t++)this.getItems()[t].setContent(this.getParent()._nTotalPage-9+t);this.getItems()[this.getItems().length-3].hide(),this.getItems()[2].show()}else for(this.getItems()[2].hide(),this.getItems()[this.getItems().length-3].show(),t=3;t<=8;t++)this.getItems()[t].setContent(1+t-2);this.selected&&this.selected.alterStatus("-selected"),this.getItems().forEach(function(t){t.getContent()==e&&(this.selected=t,this.selected.alterStatus("+selected"))}.bind(this));var i=this.getParent()._nPageSize,s=i*Number(e),n=this.getParent()._nTotal;s>n&&(s=n);var a=this.getParent()._nTotalPage;this.setPageInfoContent(e,i,s,n,a)},setPageInfoContent:function(e,t,i,s,n){this.getParent()._uPageInfo.setContent(t*Number(e)-t+1+"-"+i+" / "+s)},onready:function(){this.currentPage=this.getParent()._nPageNo,this.setSelected(this.getParent()._nPageNo)}},ecui.ui.Items),PageSize:ecui.inherits(frd.CustomSelect,function(e,t){t.size="small",frd.CustomSelect.call(this,e,t)},{onready:function(){this.setValue(this.getParent()._nPageSize+"")},onchange:function(){this.getParent()._nPageSize=this.getValue(),ecui.esr.callRoute(this.getParent().getRoute()+"~pageNo=1~pageNum=1~pageSize="+this.getValue(),!0)}}),JumpTo:ecui.inherits(ecui.ui.Number,{onkeyup:function(e){13===e.which&&this.getParent()._uPages.setPage(this.getValue())}})}),frd.Process=ecui.inherits(ecui.ui.Control,"ui-process",{$alterItems:ecui.util.blank,onready:function(){this.setSelectd(0)},next:function(){var e=this.currentIndex+1;e<this.getItems().length&&this.setSelectd(e)},setSelectd:function(e){void 0!==this.currentIndex&&(this.getItems()[this.currentIndex].alterStatus("-processing"),this.getItems()[this.currentIndex].alterStatus("+completed"));this.getItems()[e].alterStatus("+processing"),this.currentIndex=e}},ecui.ui.Items),frd.ProcessButton=ecui.inherits(frd.BaseButton,function(e,t){t.btnType="text",frd.BaseButton.call(this,e,t)},{onclick:function(){ecui.get("process").next()}}),frd.CustomProgress=ecui.inherits(ecui.ui.Control,"ui-custom-progress-bar",function(e,t){ecui.ui.Control.call(this,e,t),this._nMax=t.max,this._nValue=t.value,this._bComplateStyle=!!t.complateStyle,this._uProgress=ecui.$fastCreate(this.Progress||ecui.ui.ProgressBar,ecui.dom.first(e),this,{max:Number(t.max),value:Number(t.value)}),this._uText=ecui.$fastCreate(this.ProgressText,ecui.dom.last(e),this,{max:Number(t.max),value:Number(t.value)}),this._bError=!!t.error},{ProgressText:ecui.inherits(ecui.ui.Control,function(e,t){ecui.ui.Control.call(this,e,t),this._nMax=t.max,this._nValue=t.value},{setValue:function(e){if(e){var t=Math.round(e/this._nMax*100);this.setContent(t+"%")}else this.setContent("")},$ready:function(){ecui.ui.Control.prototype.$ready.call(this),this.setValue(this._nValue)}}),setValue:function(e){this.alterStatus("-complated"),this.alterStatus("-error"),this._uProgress.setValue(e),this._uText.setValue(e),this._bComplateStyle&&e>=this._nMax&&(this._uText.setValue(""),this.alterStatus("+complated"))},$error:function(){this._uText.setValue(""),this.alterStatus("+error")},$ready:function(){ecui.ui.Control.prototype.$ready.call(this),this._uProgress.$ready(),this._uText.$ready()}}),frd.CustomProgressBar=ecui.inherits(frd.CustomProgress,{}),frd.CustomProgressCircle=ecui.inherits(frd.CustomProgress,{Progress:ecui.inherits(ecui.ui.ProgressCircle,function(e,t){ecui.ui.ProgressCircle.call(this,e,t),this._ePath.setAttribute("fill","#E6ECFF")},{}),$error:function(){frd.CustomProgress.prototype.$error.call(this),this._uProgress._ePath.setAttribute("fill","#E0E0E0")},setValue:function(e){this._uProgress._ePath.setAttribute("fill","#E6ECFF"),frd.CustomProgress.prototype.setValue.call(this,e)}});var t=ecui.inherits(ecui.ui.Calendar,function(e,t){ecui.ui.Calendar.call(this,e,t)},{Cell:ecui.inherits(ecui.ui.Calendar.prototype.Cell,{setDate:function(e){ecui.ui.Calendar.prototype.Cell.prototype.setDate.call(this,e),this.getBody().innerHTML="<div>"+e.getDate()+"</div>"},$mousemove:function(e){ecui.ui.Calendar.prototype.Cell.prototype.$mousemove.call(this,e),ecui.dispatchEvent(this.getParent(),"datehover",{item:this})}}),$initView:function(){var e=ecui.ui.Calendar.prototype.$initView.call(this),t=this._eTitle.parentNode;return ecui.dom.children(t).forEach(function(e,t){0!==t&&(e.innerHTML="")}),e}});function i(e,t){e.$setValue(t),ecui.dispatchEvent(e,"change",{value:t})}function s(e,t,i){var s=e._eMask.style;i?(s.bottom="0px",s.height=t+"px"):(s.left="0px",s.width=t+"px")}ecui.ui.RangeSelectDate=ecui.inherits(ecui.ui.Control,"frd-range-date",function(e,t){if(ecui.ui.Control.call(this,e,t),this.isShowTime=!!t.isShowTime,this._eFromText=ecui.dom.create("DIV",{className:"ui-text ui-input"}),this._eToText=ecui.dom.create("DIV",{className:"ui-text  ui-input"}),this._eRangeCalendar=ecui.dom.create("DIV",{className:"ui-popup ui-hide ui-range-calendar"}),t.notneedDiv||(e.appendChild(this._eFromText),e.appendChild(ecui.dom.create("DIV",{innerHTML:"至"})),e.appendChild(this._eToText)),e.appendChild(this._eRangeCalendar),t.start){var i=t.start.split(" "),s=i[0].split("-");t.start=s[0]+"-"+("0"+s[1]).slice(-2)+"-"+("0"+s[2]).slice(-2)+" "+(i&&i.length>1?i[1]:"")}if(t.end){var n=t.end.split(" "),a=n[0].split("-");t.end=a[0]+"-"+("0"+a[1]).slice(-2)+"-"+("0"+a[2]).slice(-2)+" "+(n&&n.length>1?n[1]:"")}t.notneedDiv||(this._uFromText=ecui.$fastCreate(this.Text,this._eFromText,this,{placeholder:"开始时间",value:t.start,name:t.startName,isShowTime:this.isShowTime}),this._uToText=ecui.$fastCreate(this.Text,this._eToText,this,{placeholder:"结束时间",value:t.end,name:t.endName,isShowTime:this.isShowTime})),this._uRangeCalendar=ecui.$fastCreate(this.RangeCalendar,this._eRangeCalendar,this,{startDate:i&&i.length>0?new Date(s[0],s[1]-1,s[2]):"",startTime:i&&i.length>1?i[1]:"",endDate:n&&n.length>0?new Date(a[0],a[1]-1,a[2]):"",endTime:n&&n.length>1?n[1]:"",isShowTime:this.isShowTime}),this.setPopup(this._uRangeCalendar)},{Text:ecui.inherits(ecui.ui.Text,function(e,t){ecui.ui.Text.call(this,e,t),this._eInput.readOnly=!0},{}),RangeCalendar:ecui.inherits(ecui.ui.Control,function(e,t){ecui.ui.Control.call(this,e,t),this.isShowTime=t.isShowTime,this._eFrom=ecui.dom.create("DIV",{className:"ui-range-date-option"}),this._eTo=ecui.dom.create("DIV",{className:"ui-range-date-option"}),this._eButtons=ecui.dom.create("DIV",{className:"ui-range-calendar-buttons",innerHTML:'<div class="error-tips-all" style="display:none">请选择日期和输入格式正确的时间</div><div class="ui-range-date-quit">取消</div><div class="ui-range-date-confirm">确认</div>'}),e.appendChild(this._eFrom),e.appendChild(this._eTo),e.appendChild(this._eButtons),this._uFrom=ecui.$fastCreate(this.DateSelect,this._eFrom,this,{cType:1,isShowTime:this.isShowTime}),this._uTo=ecui.$fastCreate(this.DateSelect,this._eTo,this,{cType:2,isShowTime:this.isShowTime}),this._uQuit=ecui.$fastCreate(this.Quit,ecui.dom.children(this._eButtons)[1],this),this._uConfirm=ecui.$fastCreate(this.Confirm,ecui.dom.last(this._eButtons),this),this.startDate=t.startDate,this.endDate=t.endDate,this.startTime=t.startTime||"00:00:00",this.endTime=t.endTime||"00:00:00"},{$ready:function(){ecui.ui.Control.prototype.$ready.call(this)},DateSelect:ecui.inherits(ecui.ui.Control,function(e,t){ecui.ui.Control.call(this,e,t),this.isShowTime=t.isShowTime,this._eCalendar=ecui.dom.create("DIV",{className:"ui-calendar frd-range-calendar"}),e.appendChild(this._eCalendar),this._uCalendar=ecui.$fastCreate(this.Calendar,this._eCalendar,this,{cType:t.cType}),this.isShowTime&&(this._eTime=ecui.dom.create("DIV",{className:"ui-time-text",innerHTML:(1===t.cType?"<div>开始时间：</div>":"<div>结束时间：</div>")+'<div class="ui-text ui-input"></div><div class="error-tips" style="display:none;">格式:00:00:00</div>'}),e.appendChild(this._eTime),this._uTime=ecui.$fastCreate(this.TimeText,ecui.dom.children(this._eTime)[1],this,{placeholder:"00:00:00",cType:t.cType}))},{TimeText:ecui.inherits(ecui.ui.Text,function(e,t){ecui.ui.Text.call(this,e,t),this.cType=Number(t.cType)},{$blur:function(e){ecui.ui.Text.prototype.$blur.call(this,e);var t=this.getValue();/^(\d{1,2}):(\d{1,2}):(\d{1,2})$/.test(t)?this.setValue(("0"+RegExp.$1).slice(-2)+":"+("0"+RegExp.$2).slice(-2)+":"+("0"+RegExp.$3).slice(-2)):ecui.dom.last(this.getParent()._eTime).style.display=""},$focus:function(e){ecui.ui.Text.prototype.$focus.call(this,e),ecui.dom.last(this.getParent()._eTime).style.display="none"},resetTime:function(){var e=this.getParent().getParent();1===this.cType?this.setValue(e.startTime):this.setValue(e.endTime)},$ready:function(){ecui.ui.Text.prototype.$ready.call(this),this.resetTime()}}),Calendar:ecui.inherits(t,function(e,i){t.call(this,e,i),this.cType=Number(i.cType)},{Button:ecui.inherits(t.prototype.Button,{$click:function(e){t.prototype.Button.prototype.$click.call(this,e),this.getParent().clearStyle()}}),$datehover:function(e){var t=this.getParent().getParent();t.selectStartDate&&!t.selectEndDate&&(t.hovered&&t.hovered.alterStatus("-end"),e.item.alterStatus("+end"),t.hovered=e.item,t._uFrom._uCalendar.renderDateNode(t.selectStartDate,e.item.getDate()),t._uTo._uCalendar.renderDateNode(t.selectStartDate,e.item.getDate()))},$dateclick:function(e){t.prototype.$dateclick.call(this,e);var i=this.getParent().getParent();i.selectStartDate&&i.selectEndDate&&(i.selectStartDate=null,i.selectEndDate=null,i._uFrom._uCalendar.clearStyle(),i._uTo._uCalendar.clearStyle()),i.selectStartDate?i.selectEndDate=e.item.getDate():(i.selectStartDate=e.item.getDate(),e.item.alterStatus("+start"))},clearStyle:function(){this._aCells.slice(7).forEach(function(e){e.alterStatus("-inrange"),e.alterStatus("-startrange"),e.alterStatus("-endrange"),e.alterStatus("-start"),e.alterStatus("-end")})},resetDate:function(){var e=this.getParent().getParent();if(this.clearStyle(),e.startDate&&e.endDate){if(e.selectStartDate=new Date(e.startDate),e.selectEndDate=new Date(e.endDate),e.selectStartDate-e.selectEndDate>0){var t=e.selectStartDate;e.selectStartDate=e.selectEndDate,e.selectEndDate=t}if(1===this.cType)this.setView(e.selectStartDate.getFullYear(),e.selectStartDate.getMonth()+1);else{var i=e.selectStartDate.getFullYear(),s=e.selectStartDate.getMonth(),n=e.selectEndDate.getFullYear(),a=e.selectEndDate.getMonth();new Date(n,a)-new Date(i,s)>0?this.setView(n,a+1):this.setView(n,a+2)}e._uFrom._uCalendar._aCells.slice(7).forEach(function(t){t.getDate()-e.selectStartDate!=0||t._bExtra||t.alterStatus("+start"),t.getDate()-e.selectEndDate!=0||t._bExtra||t.alterStatus("+end")}),e._uTo._uCalendar._aCells.slice(7).forEach(function(t){t.getDate()-e.selectStartDate!=0||t._bExtra||t.alterStatus("+start"),t.getDate()-e.selectEndDate!=0||t._bExtra||t.alterStatus("+end")}),e._uFrom._uCalendar.renderDateNode(e.selectStartDate,e.selectEndDate),e._uTo._uCalendar.renderDateNode(e.selectStartDate,e.selectEndDate)}else{if(2===this.cType){var r=new Date;this.setView(r.getFullYear(),r.getMonth()+2)}this.clearStyle()}},$ready:function(){t.prototype.$ready.call(this),this.resetDate()},renderDateNode:function(e,t){this._aCells.slice(7).forEach(function(i){if(e-t>0){var s=e;e=t,t=s}t-e>0?i._bExtra||(i.getDate()-e>0&&i.getDate()-t<0?(i.alterStatus("+inrange"),i.alterStatus("-startrange"),i.alterStatus("-endrange")):i.getDate()-e==0?(i.alterStatus("+startrange"),i.alterStatus("-inrange"),i.alterStatus("-endrange")):i.getDate()-t==0?(i.alterStatus("-inrange"),i.alterStatus("-startrange"),i.alterStatus("+endrange")):(i.alterStatus("-inrange"),i.alterStatus("-startrange"),i.alterStatus("-endrange"))):(i.alterStatus("-startrange"),i.alterStatus("-endrange"),i.alterStatus("-inrange"))},this)},setView:function(e,t,i){frd.CustomCalendar.prototype.setView.call(this,e,t,i),(i||this._aCells).slice(7).forEach(function(e){e._bExtra?e._bCapturable=!1:e._bCapturable=!0},this)}})}),getValue:function(){return this.selectStartDate,this.selectEndDate,[]},dateFormate:function(e){return e.getFullYear()+"-"+e.getMonth()},Quit:ecui.inherits(ecui.ui.Control,{$click:function(e){ecui.ui.Control.prototype.$click.call(this,e);var t=this.getParent();t._uFrom._uCalendar.resetDate(),t._uTo._uCalendar.resetDate(),t._uFrom._uTime.resetTime(),t._uTo._uTime.resetTime(),t.hide()}}),$hide:function(){this._uFrom._uCalendar.resetDate(),this._uTo._uCalendar.resetDate(),this._uFrom._uTime&&this._uFrom._uTime.resetTime(),this._uTo._uTime&&this._uTo._uTime.resetTime()},Confirm:ecui.inherits(ecui.ui.Control,{$click:function(e){ecui.ui.Control.prototype.$click.call(this,e);var t,i,s=this.getParent();if(s.selectStartDate-s.selectEndDate>0){var n=s.selectStartDate;s.selectStartDate=s.selectEndDate,s.selectEndDate=n}s.startDate=s.selectStartDate,s.endDate=s.selectEndDate,s.isShowTime?(s.startTime=s._uFrom._uTime.getValue(),s.endTime=s._uTo._uTime.getValue(),s.startDate&&s.endDate&&s.startTime&&s.endTime?(t=ecui.util.formatDate(s.startDate,"yyyy-MM-dd")+" "+s.startTime,i=ecui.util.formatDate(s.endDate,"yyyy-MM-dd")+" "+s.endTime,s.getParent().setRangeValue(t,i),s.hide()):ecui.dom.first(s._eButtons).style.display=""):s.startDate&&s.endDate?(t=ecui.util.formatDate(s.startDate,"yyyy-MM-dd"),i=ecui.util.formatDate(s.endDate,"yyyy-MM-dd"),s.getParent().setRangeValue(t,i),s.hide()):ecui.dom.first(s._eButtons).style.display=""}})}),setRangeValue:function(e,t){this._uFromText.setValue(e),this._uToText.setValue(t)}},ecui.ui.Popup),frd.RangeSelectDate=ecui.inherits(ecui.ui.Control,"frd-range-date",function(e,t){ecui.ui.Control.call(this,e,t),t.start&&(this._startDate=new Date(t.start+" 00:00:00")),t.end&&(this._endDate=new Date(t.end+" 23:59:59")),this._eRangeCalendar=ecui.dom.create("DIV",{className:"ui-popup ui-hide ui-range-calendar frd-range-calendar-option"}),e.appendChild(this._eRangeCalendar),this._oBegin=t.beginValue?new Date(t.beginValue):new Date,this._oEnd=t.endValue?new Date(t.endValue):new Date(this._oBegin.getFullYear(),this._oBegin.getMonth()+1,1),this._uRangeCalendar=ecui.$fastCreate(this.RangeCalendar,this._eRangeCalendar,this,{startDate:this._oBegin,endDate:this._oEnd}),this.setPopup(this._uRangeCalendar),ecui.dom.insertHTML(e,"beforeEnd",'<input class="ui-hide" name="'+t.startName+'"><input class="ui-hide" name="'+t.endName+'">');var i=e.getElementsByTagName("INPUT");this._uBeginInput=ecui.$fastCreate(this.Input,i[0],this),this._uEndInput=ecui.$fastCreate(this.Input,i[1],this);var s=t.placeholder||"请选择日期",n=ecui.dom.create("DIV",{className:this.getUnitClass(frd.RangeSelectDate,"text"),innerHTML:s});ecui.dom.insertBefore(n,ecui.dom.first(e)),this._uText=ecui.$fastCreate(this.Text,ecui.dom.first(e),this,{capturable:!1,placeholder:s}),t.startValue&&t.endValue?(this._uBeginInput.setValue(t.startValue),this._uEndInput.setValue(t.endValue)):(this._uBeginInput.setValue(""),this._uEndInput.setValue("")),t.closeBtn&&(e.appendChild(ecui.dom.create("SPAN",{className:"frd-close-icon",innerHTML:'<img src="images/frd/close.png" />'})),this._uCloseBtn=ecui.$fastCreate(this.CloseBtn,ecui.dom.last(e),this))},{disabledDate:function(e){return this._startDate&&this._endDate?e>=this._startDate&&this._endDate>=e:this._startDate?e>=this._startDate:!this._endDate||this._endDate>=e},CloseBtn:ecui.inherits(ecui.ui.Control,{onclick:function(e){this.getParent().setValue(),e.stopPropagation()}}),Input:ecui.inherits(ecui.ui.InputControl,{setValue:function(e){ecui.ui.InputControl.prototype.setValue.call(this,e),this.getParent().refreshText()},setSelectValue:function(e){ecui.ui.InputControl.prototype.setValue.call(this,e)}}),Text:ecui.inherits(ecui.ui.Control,function(e,t){ecui.ui.Control.call(this,e,t),this._sPlaceholder=t.placeholder},{setValue:function(e){this._value=e,this.setContent(e||this._sPlaceholder)}}),RangeCalendar:ecui.inherits(ecui.ui.Control,function(e,t){ecui.ui.Control.call(this,e,t),this.isShowTime=t.isShowTime,this._eFrom=ecui.dom.create("DIV",{className:"ui-range-date-option"}),this._eTo=ecui.dom.create("DIV",{className:"ui-range-date-option"}),e.appendChild(this._eFrom),e.appendChild(this._eTo),this._uFrom=ecui.$fastCreate(this.DateSelect,this._eFrom,this,{cType:1,date:t.startDate}),this._uTo=ecui.$fastCreate(this.DateSelect,this._eTo,this,{cType:2,date:t.endDate}),this._selectDates=[]},{getSelectDates:function(){return this._selectDates},isCanClick:function(e,t){var i=this._uFrom.getYear(),s=this._uFrom.getMonth(),n=this._uTo.getYear(),a=this._uTo.getMonth();return e===this._uFrom&&((s+=t)>12&&(i++,s-=12),s<1&&(i--,s+=12)),e===this._uTo&&((a+=t)>12&&(n++,a-=12),a<1&&(n--,a+=12)),n>i||n===i&&a>s},setYear:function(e){return this._uCalendar.setYear(e)},DateSelect:ecui.inherits(ecui.ui.Control,function(e,t){ecui.ui.Control.call(this,e,t),this.isShowTime=t.isShowTime,this._eCalendar=ecui.dom.create("DIV",{className:"ui-calendar frd-range-calendar"}),e.appendChild(this._eCalendar),this._uCalendar=ecui.$fastCreate(this.Calendar,this._eCalendar,this,{cType:t.cType,date:t.date})},{getYear:function(){return this._uCalendar.getYear()},setDate:function(e){return this._uCalendar.setDate(e)},getMonth:function(){return this._uCalendar.getMonth()},renderDateNode:function(e){e.length<=1?this._uCalendar.refeshDateNodeStatus():this._uCalendar.renderDateNode(e[0],e[1])},resetDateNode:function(){this._uCalendar.clearStyle()},isCanClick:function(e){return this.getParent().isCanClick(this,e)},Calendar:ecui.inherits(t,function(e,i){t.call(this,e,i),this.cType=Number(i.cType)},{Button:ecui.inherits(t.prototype.Button,{$click:function(e){this.getParent().getParent().isCanClick(this._nMove)&&t.prototype.Button.prototype.$click.call(this,e)}}),$datehover:function(e){e.item._bExtra||(e.date=e.item.getDate(),ecui.dispatchEvent(this.getParent().getParent(),"datehover",e))},$dateclick:function(e){e.item._bExtra||(t.prototype.$dateclick.call(this,e),ecui.dispatchEvent(this.getParent().getParent(),"dateclick",e))},clearStyle:function(){this._aCells.slice(7).forEach(function(e){e.alterStatus("-inrange"),e.alterStatus("-startrange"),e.alterStatus("-endrange"),e.alterStatus("-start"),e.alterStatus("-end")})},refeshDateNodeStatus:function(){this._aCells.slice(7).forEach(function(e){var t=e.getDate();e._bExtra||this.setDisabledDate(this.getParent().getParent().getParent().disabledDate(t),e)},this)},renderDateNode:function(e,t){this.clearStyle();var i=e.pattern("yyyy-MM-dd"),s=t.pattern("yyyy-MM-dd");this._aCells.slice(7).forEach(function(n){var a=n.getDate(),r=a?a.pattern("yyyy-MM-dd"):"";n._bExtra||(r===i?(n.alterStatus("+startrange"),n.alterStatus("+start")):r===s?(n.alterStatus("+endrange"),n.alterStatus("+end")):a-e>0&&a-t<0&&n.alterStatus("+inrange"),this.setDisabledDate(this.getParent().getParent().getParent().disabledDate(a),n))},this)},setDisabledDate:function(e,t){e?(ecui.dom.removeClass(t.getMain(),"ui-extra"),delete t._bExtra):t._bExtra||(ecui.dom.addClass(t.getMain(),"ui-extra"),t._bExtra=!0)},setView:function(e,t,i){frd.CustomCalendar.prototype.setView.call(this,e,t,i),(i||this._aCells).slice(7).forEach(function(e){e._bExtra?e._bCapturable=!1:e._bCapturable=!0},this),this.getParent().getParent().refreshDateNode()}})}),$dateclick:function(e){var t=e.date;2===this._selectDates.length&&(this._selectDates=[]),this._selectDates.push(t),2===this._selectDates.length&&(this._selectDates.sort(function(e,t){return e-t}),ecui.dispatchEvent(this.getParent(),"change")),this._uFrom.renderDateNode(this._selectDates),this._uTo.renderDateNode(this._selectDates)},refreshDateNode:function(){this._uFrom.renderDateNode(this._selectDates),this._uTo.renderDateNode(this._selectDates)},resetDateNode:function(){this._uFrom.resetDateNode(),this._uTo.resetDateNode()},setSelectDates:function(e,t){var i=e.map(function(e){return e instanceof Date?e:new Date(e)});this._selectDates=t?[]:i;var s=i[0],n=i[1];this._uFrom.setDate(s),s.getFullYear()===n.getFullYear()&&s.getMonth()===n.getMonth()?this._uTo.setDate(new Date(n.getFullYear(),n.getMonth()+1,1)):this._uTo.setDate(i[1]),this.refreshDateNode()},$datehover:function(e){var t=e.date;if(1===this._selectDates.length){var i=[this._selectDates[0],t];i.sort(function(e,t){return e-t}),this._uFrom.renderDateNode(i),this._uTo.renderDateNode(i)}}}),onchange:function(){this.setValue(this._uRangeCalendar.getSelectDates()),this._uRangeCalendar.hide();var e=this._uBeginInput.getValue(),t=this._uEndInput.getValue();e&&t?this.alterStatus("-placeholder"):this.alterStatus("+placeholder")},setValue:function(e){if(e&&2===e.length){e=e.map(function(e){return"string"==typeof e?new Date(e):e});var t=this.dateToValue(e[0]),i=this.dateToValue(e[1]);this._uBeginInput.setSelectValue(t),this._uEndInput.setSelectValue(i),this.refreshText()}else this._uBeginInput.setSelectValue(""),this._uEndInput.setSelectValue(""),this.refreshText()},refreshText:function(){var e=this._uBeginInput.getValue(),t=this._uEndInput.getValue();e&&t?(this.setShowText([e,t]),this._uRangeCalendar.setSelectDates([e,t]),this.alterStatus("-placeholder")):(e=new Date,t=new Date(e.getFullYear(),e.getMonth()+1,1),this._uRangeCalendar.setSelectDates([e,t],!0),this._uRangeCalendar.resetDateNode(),this.setShowText(),this.alterStatus("+placeholder"))},setShowText:function(e){e?this._uText.setValue(e.join(" 至 ")):this._uText.setValue()},setRangeValue:function(e){this._uText.setValue(e[0]+" 至 "+e[1])},dateToValue:function(e){return"number"==typeof e&&(e=new Date(e)),e instanceof Date&&(e=e.getFullYear()+"-"+("0"+(e.getMonth()+1)).slice(-2)+"-"+("0"+e.getDate()).slice(-2)),e}},ecui.ui.Popup),frd.CoupleSliderBar=ecui.inherits(ecui.ui.CoupleSlider,function(e,t){ecui.ui.CoupleSlider.call(this,e,t)}),frd.SingleSliderBar=ecui.inherits(ecui.ui.InputControl,"ui-single-slider",function(e,t){var i=this.getUnitClass(frd.SingleSliderBar,"slider");ecui.dom.insertHTML(e,"afterBegin",'<div class="'+this.getUnitClass(frd.SingleSliderBar,"bg")+'"></div><div class="'+this.getUnitClass(frd.SingleSliderBar,"mask")+'"></div><div class="'+i+'"></div>');var s=ecui.dom.children(e);ecui.ui.InputControl.call(this,e,t),this._nSegment=t.segment,this._eMask=s[1],this._aSlider=ecui.$fastCreate(this.Slider,s[2],this)},{Slider:ecui.inherits(ecui.ui.Control,{$activate:function(e){ecui.ui.Control.prototype.$activate.call(this,e);var t=this.getParent(),i=t.getClientWidth();this._nSeg=this.getX()*t._nSegment/i,ecui.drag(this,e,{absolute:!0,left:0,right:i,top:0,bottom:0,limit:{stepX:i/t._nSegment}})},$dragmove:function(e){ecui.ui.Control.prototype.$dragmove.call(this,e);var t=this.getParent(),n=t.getClientWidth()/t._nSegment,a=Math.round(e.x/n);s(t,e.x),this._nSeg!==a&&(this._nSeg=a,i(t,a))}}),$click:function(e){ecui.ui.InputControl.prototype.$click.call(this,e);var t=this.getClientWidth()/this._nSegment,n=this._aSlider.getX(),a=ecui.dom.getPosition(this.getMain()),r=e.pageX-a.left;n=Math.round(r/t)*t,this._aSlider.setPosition(n,0),s(this,n),i(this,n/t)},setValue:function(e){var t=e,i=+t*(this.getClientWidth()/this._nSegment);this._aSlider.setPosition(i,this._aSlider.getY()),s(this,i),ecui.ui.InputControl.prototype.setValue.call(this,t)}}),frd.SingleSliderBarVertical=ecui.inherits(ecui.ui.InputControl,"ui-single-slider-vertical",function(e,t){var i=this.getUnitClass(frd.SingleSliderBarVertical,"slider");ecui.dom.insertHTML(e,"afterBegin",'<div class="'+this.getUnitClass(frd.SingleSliderBarVertical,"bg")+'"></div><div class="'+this.getUnitClass(frd.SingleSliderBarVertical,"mask")+'"></div><div class="'+i+'"></div>');var s=ecui.dom.children(e);ecui.ui.InputControl.call(this,e,t),this._nSegment=t.segment,this._eMask=s[1],this._aSlider=ecui.$fastCreate(this.Slider,s[2],this)},{Slider:ecui.inherits(ecui.ui.Control,{$activate:function(e){ecui.ui.Control.prototype.$activate.call(this,e);var t=this.getParent(),i=t.getClientHeight();this._nSeg=this.getY()*t._nSegment/i,ecui.drag(this,e,{absolute:!0,left:0,right:0,top:0,bottom:i,limit:{stepY:i/t._nSegment}})},$dragmove:function(e){ecui.ui.Control.prototype.$dragmove.call(this,e);var t=this.getParent(),n=t.getClientHeight(),a=n/t._nSegment,r=Math.round(e.y/a);s(t,n-e.y,!0),this._nSeg!==r&&(this._nSeg=r,i(t,r))}}),$click:function(e){ecui.ui.InputControl.prototype.$click.call(this,e);var t=this.getClientHeight()/this._nSegment,i=this._aSlider.getY(),n=ecui.dom.getPosition(this.getMain()),a=e.pageY-n.top;i=Math.round(a/t)*t,this._aSlider.setPosition(0,i),s(this,this.getClientHeight()-i,!0)},setValue:function(e){}}),frd.CustomTab=ecui.inherits(ecui.ui.Tab,function(e,t){ecui.ui.Tab.call(this,e,t),this._sStyle=t.style},{onready:function(){this._sStyle&&this.alterStatus("+"+this._sStyle)}}),frd.TimeSelect=ecui.inherits(ecui.ui.Text,"ui-time-select",function(e,t){ecui.ui.Text.call(this,e,t),this._placeholder=t.placeholder||"请选择",this._eText=ecui.dom.create("DIV",{className:"ui-time-select-text",innerHTML:this._placeholder}),e.appendChild(this._eText),this._uText=ecui.$fastCreate(ecui.ui.Control,this._eText,this),this._ePopOptions=ecui.dom.create("DIV",{className:"ui-time-select-options ui-popup ui-hide"}),this._ePopOptions.innerHTML='<div class="time-list-wrap">  <div class="time-list" range="0-23">  </div>  <div class="time-list" range="0-59">  </div>  <div class="time-list" range="0-59">  </div></div><div class="options">  <div class="quit">取消</div>  <div class="confirm">确定</div></div>',e.appendChild(this._ePopOptions),this._uOptions=ecui.$fastCreate(this.PopOptions,this._ePopOptions,this),this.setPopup(this._uOptions),t.value&&this.setValue(t.value)},{PopOptions:ecui.inherits(ecui.ui.Control,function(e,t){ecui.ui.Control.call(this,e,t),this._sTimeLists=ecui.dom.children(ecui.dom.first(e)).map(function(e){return ecui.$fastCreate(this.PopList,e,this)}.bind(this)),ecui.$fastCreate(this.Quit,ecui.dom.first(ecui.dom.last(e)),this),ecui.$fastCreate(this.Confirm,ecui.dom.last(ecui.dom.last(e)),this)},{PopList:ecui.inherits(ecui.ui.Control,function(e,t){ecui.ui.Control.call(this,e,t);for(var i=e.getAttribute("range").split("-"),s=Number(i[0]),n=Number(i[1]),a=document.createDocumentFragment(),r=s;r<n+1;r++)a.appendChild(ecui.dom.create("DIV",{innerHTML:("0"+r).slice(-2)}));e.appendChild(a)},{onitemclick:function(e){this.setSelected(e.index)},setSelected:function(e){this.selected&&this.selected.alterStatus("-selected"),this.selected=this.getItems()[e],this.selected.alterStatus("+selected")}},ecui.ui.Items),Quit:ecui.inherits(ecui.ui.Control,{onclick:function(){this.getParent().hide()}}),Confirm:ecui.inherits(ecui.ui.Control,{onclick:function(){var e="";this.getParent()._sTimeLists.forEach(function(t){e+=":"+t.selected.getContent()}),this.getParent().getParent().setValue(e.slice(1)),this.getParent().hide()}}),show:function(e){ecui.ui.Control.prototype.show.call(this,e),setTimeout(function(){this._sTimeLists.forEach(function(e){e.selected&&ecui.dom.scrollIntoViewIfNeeded(e.selected.getMain())})}.bind(this),0)},setSelectItem:function(e){3===e.length&&this._sTimeLists.forEach(function(t,i){t.setSelected(Number(e[i]))})}}),setValue:function(e){this._eInput.value=e,this.setText(e),e&&this._uOptions.setSelectItem(String(e).split(":").map(function(e){return Number(e)}))},setText:function(e){this._uText.setContent(e||this._placeholder)}},ecui.ui.Popup),ecui.ext.tips={constructor:function(e){if(/^(.+)@(left|right|top|bottom)$/.test(e)){var t=RegExp.$2;e=RegExp.$1}else t="bottom";this.tipsEl=ecui.dom.create("DIV",{className:"ui-simple-tips",innerText:e});var i=this.getMain();i.appendChild(this.tipsEl),this.tipsEl.style.position="fixed";var s=(i.offsetHeight-this.tipsEl.offsetHeight)/2,n=(i.offsetWidth-this.tipsEl.offsetWidth)/2,a=ecui.dom.getPosition(i);switch(t){case"left":this.tipsEl.style.top=a.top+s+"px",this.tipsEl.style.left=a.left-this.tipsEl.offsetWidth-10+"px";break;case"right":this.tipsEl.style.top=a.top+s+"px",this.tipsEl.style.left=a.left+i.offsetWidth+10+"px";break;case"top":this.tipsEl.style.top=a.top-this.tipsEl.offsetHeight-10+"px",this.tipsEl.style.left=a.left+n+"px";break;case"bottom":this.tipsEl.style.top=a.top+i.offsetHeight+10+"px",this.tipsEl.style.left=a.left+n+"px"}this.tipsEl.style.display="none"},Events:{mouseover:function(){this.tipsEl.style.display=""},mouseout:function(){this.tipsEl.style.display="none"},mousewheel:function(){this.tipsEl.style.display="none"},dispose:function(){delete this.tipsEl}}};var n=ecui.inherits(ecui.ui.Control,!0,function(e,t){ecui.ui.Control.call(this,e,t),this.tipsEl=ecui.dom.create("DIV"),document.body.appendChild(this.tipsEl),this.tipsEl.style.display="none"},{showTips:function(){this.tipsEl.style.display="",ecui.util.timer(function(){this.tipsEl.style.display="none"}.bind(this),1500)},close:function(){this.tipsEl.style.display="none"},CloseBtn:ecui.inherits(ecui.ui.Control,{onclick:function(){this.getParent().close()}})});window.GlobalTip=n;var a,r,o=ecui.inherits(ecui.ui.Control,{onclick:function(){this.getMain().parentNode.remove()}});function c(){return a||(a=ecui.dom.create("DIV",{className:"ui-notify-wrap"}),document.body.appendChild(a),a)}ecui.globalTips=function(e,t,i,s){var a=ecui.getSingleton(n);a.tipsEl.className="ui-global-tips",a.tipsEl.style.position="fixed",t=t||"line",ecui.dom.addClass(a.tipsEl,"ui-global-tips-"+t),s=s||"line",ecui.dom.addClass(a.tipsEl,"ui-global-tips-"+s),a.tipsEl.innerText=e,i=i||"top",a.showTips(),"top"===i?(a.tipsEl.style.top="20px",a.tipsEl.style.left=(document.body.offsetWidth-a.tipsEl.offsetWidth)/2+"px"):(a.tipsEl.style.top=document.body.offsetHeight-a.tipsEl.offsetHeight-20+"px",a.tipsEl.style.left="200px")},ecui.ui.GlobalTipsTarget=ecui.inherits(ecui.ui.Control,function(e,t){ecui.ui.Control.call(this,e,t),this._sTipType=t.tipType,this._sTipPos=t.tipPos,this._sTipShape=t.tipShape},{onclick:function(){ecui.globalTips("这是简易提示框这是简易提示框这是简易提示框这是简易",this._sTipType,this._sTipPos,this._sTipShape)}}),ecui.notify=function(e,t,i,s){var n=ecui.dom.create("DIV",{className:"ui-notify "+("normal"===i?"ui-notify-normal":"ui-notify-options")}),a=ecui.dom.create("DIV",{className:"ui-notify-close"}),r=ecui.dom.create("DIV",{className:"ui-notify-title",innerHTML:e}),l=ecui.dom.create("DIV",{className:"ui-notify-content",innerHTML:t});if("options"===i)var u=ecui.dom.create("DIV",{className:"ui-notify-delay",innerHTML:"推迟"}),h=ecui.dom.create("DIV",{className:"ui-notify-confirm",innerHTML:"确定"});n.appendChild(a),n.appendChild(r),n.appendChild(l),u&&h&&(n.appendChild(u),n.appendChild(h),ecui.$fastCreate(o,u),ecui.$fastCreate(o,h)),ecui.$fastCreate(o,a),c().appendChild(n),ecui.dom.children(c()).length>=4&&ecui.dom.first(c()).remove(),ecui.util.timer(function(){n&&n.remove()},5e3)},ecui.ui.NotifyTarget=ecui.inherits(ecui.ui.Control,function(e,t){ecui.ui.Control.call(this,e,t),this.tipType=t.tipType||"normal"},{onclick:function(){ecui.notify("标题白体贴","标题白体贴标题白体贴标题白体贴标题白体贴标题白体贴标题白体贴标题白体贴",this.tipType)}}),ecui.dialog=function(e,t){var i=ecui.dom.create("div");i.innerHTML=ecui.esr.getEngine().render(e,t);var s=ecui.dom.first(i);document.body.appendChild(s),ecui.init(s);var n=s.getControl();i.remove(),n.showModal(),n.hide=function(){ecui.ui.DialogTarget.prototype.hide.call(this),ecui.dispose(s),s.remove()}},ecui.ui.DialogTarget=ecui.inherits(ecui.ui.Control,function(e,t){ecui.ui.Control.call(this,e,t),this._bTitle=!!t.title},{onclick:function(){this._bTitle?ecui.dialog("confirmTitleDialog"):ecui.dialog("confirmDialog")}}),frd.ConfirmButton=ecui.inherits(frd.BaseButton,function(e,t){frd.BaseButton.call(this,e,t),this._sType=t.kType},{onclick:function(){var e=frd.util.findControl(this,ecui.ui.Dialog);r?r&&r(this._sType,e)&&e&&e.hide():e&&e.hide()}}),frd.AsynConfirmButton=ecui.inherits(frd.ConfirmButton,{onclick:function(){var e=frd.util.findControl(this,ecui.ui.Dialog);r?r&&r(this._sType,e,function(){e&&e.hide()}):e&&e.hide()}}),frd.confirm=function(e,t,i){r=t,void 0===e.showCancel&&(e.showCancel=!0),void 0===e.showOptions&&(e.showOptions=!0);var s='<div class="${className} frd-confirm-dialog" ui="type:dialog">                         <strong >${title}</strong>                         <div class="frd-dialog-content-wrap">                             <div class="frd-dialog-content">${content}</div>                             \x3c!-- if: ${showOptions} --\x3e                             <div class="frd-dialog-content-options">                                 \x3c!-- if: ${showCancel} --\x3e                                 <div ui="type:frd.ConfirmButton;btnType:secondary;kType:cancel;"><span>取消</span></div>                                 \x3c!-- /if --\x3e                                 <div ui="type:frd.ConfirmButton;btnType:primary;kType:ok;"><span>确认</span></div>                             </div>                             \x3c!-- /if --\x3e                         </div>                     </div>';i&&(s='<div class="${className} frd-confirm-dialog" ui="type:dialog">                         <strong >${title}</strong>                         <div class="frd-dialog-content-wrap">                             <div class="frd-dialog-content">${content}</div>                             \x3c!-- if: ${showOptions} --\x3e                             <div class="frd-dialog-content-options">                                 \x3c!-- if: ${showCancel} --\x3e                                 <div ui="type:frd.AsynConfirmButton;btnType:secondary;kType:cancel;"><span>取消</span></div>                                 \x3c!-- /if --\x3e                                 <div ui="type:frd.AsynConfirmButton;btnType:primary;kType:ok;"><span>确认</span></div>                             </div>                             \x3c!-- /if --\x3e                         </div>                     </div>'),e.content&&(s=s.replace("${content}",e.content));var n=document.querySelector("#dialogContainer");n||(n=ecui.dom.create("div",{id:"dialogContainer"}),document.body.appendChild(n)),n.innerHTML=frd.util.compileTemplate(s,e),ecui.init(n),ecui.dom.first(n).getControl().showModal()},frd.asynConfirm=function(e,t){frd.confirm(e,t,!0)};var l=(/(msie (\d+\.\d)|IEMobile\/(\d+\.\d))/i.test(navigator.userAgent)?document.documentMode||+(RegExp.$2||RegExp.$3):void 0)<9?function(){var e=this.getUID(),t=ecui.dom.create("IFRAME",{name:e,className:"ui-hide"});this._eFile.name="file";var i=this._eFile.value.split("\\");this.fileName=i[i.length-1],document.body.appendChild(t),ecui.dom.insertHTML(document.body,"beforeEnd",'<form action="'+this._sUrl+'" method="POST" enctype="multipart/form-data" target="'+e+'"></form>');var s=document.body.lastChild;t.onreadystatechange=function(){if(t.contentDocument.body&&"complete"===t.readyState){var e=t.contentDocument.body.innerHTML;t.onreadystatechange=null,document.body.removeChild(s),document.body.removeChild(t),this.onupload(e)}}.bind(this);var n=this._eFile.cloneNode(!1);ecui.dom.insertBefore(n,this._eFile),s.appendChild(this._eFile),this._eFile=n,s.submit()}:function(){var e=[],t=Array.prototype.slice.call(this._eFile.files,0),i="";t.forEach(function(e){i+=ecui.esr.getEngine().render("fileItem",{fileName:e.name})});var s=ecui.dom.create("div");s.innerHTML=i,e=ecui.dom.children(s),this._uFileList.add(e),t.forEach(function(t,i){var s=ecui.query(function(t){return t instanceof ecui.ui.Progress&&ecui.dom.contain(e[i],t.getMain())},this)[0],n=new FileReader;this.fileName=t.name,n.readAsDataURL(t),n.onload=function(){var n=new FormData;n.append("file",t),ecui.io.ajax(this._sUrl,{method:"POST",data:n,onupload:s?function(e){s.setMax(e.total),s.setValue(e.loaded)}:void 0,onsuccess:function(t){this.onupload.call(this,t),e[i].getElementsByTagName("IMG")[0].src="images/frd/upload-success.png",s.hide()}.bind(this),onerror:this.onerror?function(t){this.onerror.call(this,t),e[i].getElementsByTagName("IMG")[0].src="images/frd/upload-fail.png",s.hide()}.bind(this):ecui.util.blank})}.bind(this)}.bind(this))};frd.UploadFiles=ecui.inherits(ecui.ui.Upload,function(e,t){ecui.ui.Upload.call(this,e,t),this._eFile=e.getElementsByTagName("INPUT")[0],this._eSelectButton=e.getElementsByTagName("STRONG")[0],ecui.$fastCreate(this.SelectButton,this._eSelectButton,this,{}),this._uFileList=ecui.$fastCreate(this.FileList,ecui.dom.last(e),this,{})},{FileList:ecui.inherits(ecui.ui.Control,function(e,t){ecui.ui.Control.call(this,e,t)},{Item:ecui.inherits(ecui.ui.Item,function(e,t){ecui.ui.Item.call(this,e,t),ecui.$fastCreate(this.Delete,ecui.dom.last(e),this,{})},{Delete:ecui.inherits(ecui.ui.Control,{onclick:function(){var e=this.getParent();e.getParent().remove(e)}})}),$alterItems:ecui.util.blank},ecui.ui.Items),$ready:function(e){ecui.ui.Control.prototype.$ready.call(this,e),ecui.dom.addEventListener(this._eFile,"change",l.bind(this))},SelectButton:ecui.inherits(ecui.ui.Control,{$click:function(){ecui.ui.Control.prototype.$click.call(this),this.getParent().getFileEl().click()}}),onupload:function(e){this._eFile.name&&(this._eFile.name=""),e=JSON.parse(e),this._eFile.value="",0===e.code||ecui.tip("error",e.msg)},onerror:function(e){this._eFile.value=""},getFileEl:function(){return this._eFile}}),frd.UploadProgress=ecui.inherits(ecui.ui.ProgressBar,"ui-custom-progress-bar"),frd.Canvas=ecui.inherits(ecui.ui.Control,"frd-canvas",{$panelselected:function(e){this.selected&&(this.selected.alterStatus("-selected"),this.setResizePosition(null,null,this.selected.getY()+4,this.selected.getX()+4)),this.selected=e.panel,this.setResizePosition(null,null,this.selected.getY()-4,this.selected.getX()-4),this.selected.alterStatus("+selected")},onclick:function(e){e.target===this.getMain()&&(!this.selected||this.resizing||this.rotating||(this.setResizePosition(null,null,this.selected.getY()+4,this.selected.getX()+4),this.selected.alterStatus("-selected"),this.selected=null))},$activate:function(e){ecui.ui.Control.prototype.$activate.call(this,e),this.selected&&ecui.dom.contain(this.selected.getMain(),e.target)&&("resize"===this.selected.moveType?this.resizing=!0:"rotate"===this.selected.moveType&&(this.rotating=!0))},$deactivate:function(e){ecui.ui.Control.prototype.$deactivate.call(this,e),this.resizing=!1,this.rotating=!1,this.selected&&(this.selected.cache(!0),this.selected.initStructure(),this.selected.centerX=this.selected.getX()+this.selected.getWidth()/2,this.selected.centerY=this.selected.getY()+this.selected.getHeight()/2,this.selected.rotateBaseX=this.selected.centerX,this.selected.rotateBaseY=this.selected.getY()-20)},setResizePosition:function(e,t,i,s){var n=this.selected.getMain();null===e&&void 0===e||(n.style.width=e+"px"),null===t&&void 0===t||(n.style.height=t+"px"),null===i&&void 0===i||(n.style.top=i+"px"),null===s&&void 0===s||(n.style.left=s+"px")},onmousemove:function(e){if(this.selected){var t=this.selected.getMain();if(this.resizing)"n"===this.selected.resizeType?this.setResizePosition(null,t.clientHeight-e.getNative().movementY,this.selected.getY()+e.getNative().movementY,null):"nw"===this.selected.resizeType?this.setResizePosition(t.clientWidth-e.getNative().movementX,t.clientHeight-e.getNative().movementY,this.selected.getY()+e.getNative().movementY,this.selected.getX()+e.getNative().movementX):"ne"===this.selected.resizeType?this.setResizePosition(t.clientWidth+e.getNative().movementX,t.clientHeight-e.getNative().movementY,this.selected.getY()+e.getNative().movementY,null):"w"===this.selected.resizeType?this.setResizePosition(t.clientWidth-e.getNative().movementX,null,null,this.selected.getX()+e.getNative().movementX):"sw"===this.selected.resizeType?this.setResizePosition(t.clientWidth-e.getNative().movementX,t.clientHeight+e.getNative().movementY,null,this.selected.getX()+e.getNative().movementX):"s"===this.selected.resizeType?this.setResizePosition(null,t.clientHeight+e.getNative().movementY,null,null):"se"===this.selected.resizeType?this.setResizePosition(t.clientWidth+e.getNative().movementX,t.clientHeight+e.getNative().movementY,null,null):"e"===this.selected.resizeType&&this.setResizePosition(t.clientWidth+e.getNative().movementX,null,null,null),this.selected._eRotate.style.left=t.clientWidth/2-10+"px";else if(this.rotating){var i=this.selected.rotateBaseX,s=this.selected.rotateBaseY,n=e.clientX-this.pos.left,a=e.clientY-this.pos.top,r=this.selected.centerX,o=this.selected.centerY,c=Math.sqrt((n-i)*(n-i)+(a-s)*(a-s)),l=Math.sqrt((n-r)*(n-r)+(a-o)*(a-o)),u=Math.sqrt((i-r)*(i-r)+(s-o)*(s-o)),h=Math.round(180*Math.acos((l*l+u*u-c*c)/(2*l*u))/Math.PI);n-i<0&&(h=360-h),t.style.transform="rotate("+h+"deg)"}if(this.isActived()){var d=t.style;this.selected.properties.width=Number(d.width.replace("px","")),this.selected.properties.height=Number(d.height.replace("px","")),this.selected.properties.top=Number(d.top.replace("px",""))+4,this.selected.properties.left=Number(d.left.replace("px",""))+4,this.selected.properties.angle=Number(d.transform.replace(/[^0-9]/g,"")),this.selected.setPropertiesForm(),ecui.dispatchEvent(this.selected,"resizing",{width:this.selected.properties.width,height:this.selected.properties.height,top:this.selected.properties.top,left:this.selected.properties.left})}}},onready:function(){this.pos=ecui.dom.getPosition(this.getMain())},add:function(e){var t=this.TextDragPanel||frd.TextDragPanel,i=this.ImgDragPanel||frd.ImgDragPanel,s=ecui.dom.create("div",{className:"frd-drag-panel"});if(this.getMain().appendChild(s),"text"===e.type)var n=ecui.$fastCreate(t,s,this,e);else n=ecui.$fastCreate(i,s,this,e);return n},delete:function(e){e&&(e.getMain().remove(),e.dispose())},getSelected:function(){return this.selected}}),frd.DragPanel=ecui.inherits(ecui.ui.Control,"frd-drag-panel",function(e,t){ecui.ui.Control.call(this,e,t),this._eRotate=ecui.dom.create("div",{className:"panel-rotate"}),e.appendChild(this._eRotate),this.defaultW=t.width||100,this.defaultH=t.height||100,this.defaultT=t.top||4,this.defaultL=t.left||4,this.defaultA=t.angle||0,this.defaultOpacity=t.opacity||1,this.defaultZIndex=t.zIndex||0,this.properties={width:this.defaultW,height:this.defaultH,top:this.defaultT,left:this.defaultL,angle:this.defaultA,opacity:this.defaultOpacity,zIndex:this.defaultZIndex}},{$activate:function(e){ecui.ui.Control.prototype.$activate.call(this,e),this.setSelected(),this.moveType&&"move"!==this.moveType?"rotate"===this.moveType&&(this.getMain().style.cursor="grabbing"):(ecui.drag(this,e,{top:-1e3,left:-1e3,bottom:2e3,right:2e3}),this.getMain().style.cursor="move")},$deactivate:function(e){ecui.ui.Control.prototype.$deactivate.call(this,e),this.getMain().style.cursor="default"},setSelected:function(){ecui.dispatchEvent(this.getParent(),"panelselected",{panel:this})},setResizeStatus:function(e){this.getMain().style.cursor=e+"-resize",this.resizeType=e},onmousemove:function(e){this.isActived()||(e.target===this.getMain()?(this.moveType="resize",Math.abs(e.getNative().offsetY)<10&&Math.abs(e.getNative().offsetX)>10&&Math.abs(e.getNative().offsetX)<this.getWidth()-10?this.setResizeStatus("n"):Math.abs(e.getNative().offsetY)<=10&&Math.abs(e.getNative().offsetX)<=10?this.setResizeStatus("nw"):Math.abs(e.getNative().offsetY)<=10&&Math.abs(e.getNative().offsetX)>=this.getWidth()-10?this.setResizeStatus("ne"):Math.abs(e.getNative().offsetX)<10&&Math.abs(e.getNative().offsetY)>10&&Math.abs(e.getNative().offsetY)<this.getHeight()-10?this.setResizeStatus("w"):Math.abs(e.getNative().offsetX)<=10&&Math.abs(e.getNative().offsetY)>=this.getHeight()-10?this.setResizeStatus("sw"):Math.abs(e.getNative().offsetX)<this.getWidth()-10&&Math.abs(e.getNative().offsetX)>10&&Math.abs(e.getNative().offsetY)>this.getHeight()-10?this.setResizeStatus("s"):Math.abs(e.getNative().offsetX)>=this.getWidth()-10&&Math.abs(e.getNative().offsetY)>=this.getHeight()-10?this.setResizeStatus("se"):Math.abs(e.getNative().offsetY)<this.getHeight()-10&&Math.abs(e.getNative().offsetY)>10&&Math.abs(e.getNative().offsetX)>this.getWidth()-10&&this.setResizeStatus("e")):e.target===this._eRotate?(this.moveType="rotate",this.getMain().style.cursor="grab",this.resizeType="none"):(this.moveType="move",this.getMain().style.cursor="default",this.resizeType="none"))},setPanelFromProperties:function(e){var t=this.getMain().style;t.width=e.width+"px",t.height=e.height+"px",t.top=e.top+"px",t.left=e.left+"px",t.zIndex=e.zIndex,void 0!==e.angle&&(t.transform="rotate("+e.angle+"deg)"),void 0!==e.opacity&&(t.opacity=e.opacity),this._eRotate.style.left=e.width/2-5+"px",this.cache(!0),this.initStructure(),this.centerX=this.getX()+this.getWidth()/2,this.centerY=this.getY()+this.getHeight()/2,this.rotateBaseX=this.centerX,this.rotateBaseY=this.getY()-20},init:function(){ecui.ui.Control.prototype.init.call(this),this.setPanelFromProperties(this.properties)},setPropertiesForm:function(){}}),frd.ImgDragPanel=ecui.inherits(frd.DragPanel,function(e,t){frd.DragPanel.call(this,e,t),this.properties.src=t.src||"",this._eImg=ecui.dom.create("img"),this._eImg.ondragstart=function(){return!1},e.appendChild(this._eImg)},{setPanelFromProperties:function(e){frd.DragPanel.prototype.setPanelFromProperties.call(this,e),e.src&&(this._eImg.src=e.src),this.setImgSize(e.width,e.height)},setImgSize:function(e,t){if(this._eImg.width&&this._eImg.height)var i=this._eImg.width/this._eImg.height;else i=1;e>t*i?(this._eImg.style.height=t+"px",this._eImg.style.width="auto"):(this._eImg.style.height="auto",this._eImg.style.width=e+"px")},$resizing:function(e){this.setImgSize(e.width,e.height)}}),frd.TextDragPanel=ecui.inherits(frd.DragPanel,function(e,t){frd.DragPanel.call(this,e,t),this.textEl=ecui.dom.create("div",{className:"text-content"}),e.appendChild(this.textEl),this.properties.fontFamily=t.fontFamily||"微软雅黑",this.properties.fontSize=t.fontSize||"14",this.properties.fontColor=t.fontColor||"#000000",this.properties.fontWeight=t.fontWeight||"normal",this.properties.fontStyle=t.fontStyle||"normal",this.properties.textDecoration=t.textDecoration||"none",this.properties.textAlign=t.textAlign||"left",this.properties.text=t.text||"标题文案",this.text=t.text,this.textEl.innerHTML=this.text},{setText:function(e){this.textEl.innerHTML=e},setPanelFromProperties:function(e){frd.DragPanel.prototype.setPanelFromProperties.call(this,e);var t=this.getMain().style;t.fontFamily=e.fontFamily,t.fontSize=e.fontSize+"px",t.color=e.fontColor,t.fontWeight=e.fontWeight,t.fontStyle=e.fontStyle,t.textDecoration=e.textDecoration,t.textAlign=e.textAlign,this.setText(e.text)}}),frd.MultiSelect=ecui.inherits(ecui.ui.InputControl,"ui-multi-select",function(e,t){for(var i=ecui.dom.create({className:this.getUnitClass(frd.MultiSelect,"listbox")});e.firstChild;)i.appendChild(e.firstChild);ecui.ui.InputControl.call(this,e,t),ecui.dom.insertBefore(this._eText=ecui.dom.create("DIV",{className:this.getUnitClass(frd.MultiSelect,"text")}),ecui.dom.last(e));var s=ecui.dom.create("DIV",{className:this.getUnitClass(frd.MultiSelect,"options")+this.Popup.CLASS+" ui-popup ui-hide",innerHTML:ecui.util.stringFormat('<input class="{0} frd-input" ui="text" placeholder="{1}">',this.Popup.CLASS+" ui-multi-select-search-input",t.placeholder||"搜索")});s.appendChild(i),this.setPopup(ecui.$fastCreate(this.Popup,s,this,{name:t.name})),this._sName=t.name||""},{TEXT:"已选{0}个",Option:ecui.inherits(ecui.ui.Control,function(e,t){ecui.ui.Control.call(this,e,t),this._uClose=ecui.$fastCreate(this.Close,e.appendChild(ecui.dom.create("DIV",{className:"ui-tree-select-item-close"})),this),this._sValue=t.value,this._sText=t.text},{Close:ecui.inherits(ecui.ui.Control,{onclick:function(){this.getParent().getParent().removeItem(this.getParent())}}),getValue:function(){return this._sValue},getText:function(){return this._sText}}),Popup:ecui.inherits(ecui.ui.Control,function(e,t){ecui.ui.Control.call(this,e,t),this._uSearchInput=ecui.$fastCreate(this.SearchInput,ecui.dom.first(e),this),this._uOptions=ecui.$fastCreate(this.Options,ecui.dom.last(e),this,{name:t.name})},{SearchInput:ecui.inherits(ecui.ui.Text,{$input:function(e){this.searchItems()},searchItems:function(){var e=this.getValue();this.getParent()._uOptions.getItems().forEach(function(t){t.getBody().innerText.indexOf(e)>=0?t.show():t.hide()})}}),Options:ecui.inherits(ecui.ui.Listbox,{Item:ecui.inherits(ecui.ui.Listbox.prototype.Item,{$click:function(e){ecui.ui.Listbox.prototype.Item.prototype.$click.call(this,e),ecui.dispatchEvent(this.getParent().getParent().getParent(),"change",e)}})})}),$change:function(e){this.changeHandler(e.item)},$dispose:function(){this._eText=null,ecui.ui.InputControl.prototype.$dispose.call(this)},getOptions:function(){return this.getPopup()._uOptions},onready:function(){this._oItems=[];var e=this.getValue(),t=this;this.getOptions().getItems().forEach(function(i){if(e.indexOf(i.getValue())>-1&&i.setSelected(!0),i.isSelected()){var s=ecui.dom.create({className:"ui-tree-select-item",innerHTML:i.getMain().innerText.trim()});t._oItems.push(ecui.$fastCreate(t.Option,s,t,{value:i.getValue(),text:i.getContent()})),t._eText.appendChild(s)}}),this._oItems.length>0&&ecui.dom.addClass(this._eText,"scrollStyle")},changeHandler:function(e){var t=[],i=[];this.getSelected().forEach(function(e){t.push(e.getBody().innerText.trim()),i.push(e.getValue())});var s=this._oItems.filter(function(t){return t.getValue()===e.getValue()});if(s.length>0){var n=this._oItems.indexOf(s[0]);this._oItems.splice(n,1),ecui.dom.remove(s[0].getMain()),s[0].dispose()}if(e.isSelected()){var a=ecui.dom.create({className:"ui-tree-select-item",innerHTML:e.getMain().innerText.trim()});this._oItems.push(ecui.$fastCreate(this.Option,a,this,{value:e.getValue(),text:e.getContent()})),this._eText.appendChild(a)}this.setValue(i.join(","))},setValue:function(e){e||(this._eText.innerHTML=""),ecui.ui.InputControl.prototype.setValue.call(this,e)},getName:function(){return this._sName},getSelected:function(){return this.getOptions().getSelected()},getValue:function(){var e=ecui.ui.InputControl.prototype.getValue.call(this).trim();return""!==e?e.split(","):[]},selectAll:function(){this.getOptions().selectAll()},setName:function(e){this.getOptions().setName(e)},removeItem:function(e){var t=this._oItems.indexOf(e),i=e.getValue();this._oItems.splice(t,1),ecui.dom.remove(e.getMain()),e.dispose(),this.repaint(),this.updatePosition();var s=this.getValue(),n=this.getValue().indexOf(i);s.splice(n,1),this.getOptions().getItems().forEach(function(e){s.indexOf(e.getValue())>-1?e.setSelected(!0):e.setSelected(!1)}),this.setValue(s)}},ecui.ui.Popup)}();
